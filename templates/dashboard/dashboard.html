<!DOCTYPE html>
<html>

<head>
<!-- Global site tag (gtag.js) - Google Analytics --> 
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-142111749-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-142111749-1');
</script>


<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCTAD:Open Cancer Therapeutic Discovery</title>
	<link rel="shortcut icon" href="{{ url_for('static', filename='img/optraIcon.png') }}" type="image/x-icon">

	{% include 'base/css_links.html' %}


	<style type="text/css">
		.ui-autocomplete {
			height: 200px;
			overflow-y: scroll;
			overflow-x: hidden;
		}
		table.dataTable tr th.select-checkbox.selected::after {
		    content: "âœ”";
		    margin-top: -11px;
		    margin-left: -4px;
		    text-align: center;
		    text-shadow: rgb(176, 190, 217) 1px 1px, rgb(176, 190, 217) -1px -1px, rgb(176, 190, 217) 1px -1px, rgb(176, 190, 217) -1px 1px;
		}
		.blockMsg {
			border: none !important;
			background-color: rgba(249, 249, 249, 0.82) !important;
			border-radius: 25px 25px;
		}
		.blockUI{
			padding: 10px !important;
		}

	</style>

</head>

<body class=""><!-- mini-navbar -->
    	{% include 'base/navBar.html' %}

        <div class="navbar-header navToggleBtn">
            <a class="navbar-minimalize minimalize-styl-2 btn btn-primary m-n" href="#"><i class="fa fa-bars"></i> </a>
        </div>

        {% include 'base/header.html' %}

		<div id="page-wrapper" class="gray-bg sideNavBody"><!-- btmNavBody -->

			<div class="wrapper wrapper-content full-height">

				<!-- loading animation shown on intial page load only -->
				<div id="page-loader" style="height:100%;display:none;">
					<img src="/static/img/ajax-loader.gif" style="margin: 15% 10% 10% 48%">
				</div>

			
				<div id="wrapper">

					<center>
					{% with messages = get_flashed_messages(with_categories=true) %}
					{% if messages %}
						{% for category, message in messages %}
							<div class="row">
								<div class="col-md-4"></div>
								{% if category == 'error' %}
									<div class="alert alert-danger alert-dismissable" >
										<button type="button" style="text-align: center" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
										{{ message }}
									</div>
								{% else %}
									<div class="alert alert-success alert-dismissable" >
										<button type="button" style="text-align: center" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
										{{ message }}
									</div>
								{% endif %}
								<div class="col-md-4"></div>
							</div>
						{% endfor %}
					{% endif %}
					{% endwith %}
				</center>

				<form id="form" action="#" method="post" class="wizard-big full-height filter-form" style="display: none;">
					<!-- <img id="loaderIcon" src="/static/img/loading.gif" style="display: none;"> -->
					{% if job %}
						<input type="hidden" name="job_id" id="job_id" value="{{ job.id }}">
					{% else %}
						<input type="hidden" name="job_id" id="job_id">
					{% endif %}

					<!--*************************************** 1. case -->
					<h1>Case</h1>
					<fieldset>
						<div class="row m-b-xs">
							<div id="caseFilterDiv" class="col-lg-7">
								<div class="form-group">
									<div class="row m-n" id="auto_manual_option">
										<div class="col-lg-2">
											<span>
												<input type="radio" id="auto_case" name="case_selection" value="auto_case" checked>
												<i></i> Auto
											</span>
										</div>
										<div class="col-lg-3" style="display:none;">
											<sapn>
												<input type="radio" id="manual_case" name="case_selection" value="manual_case">
												<i></i> Manual
											</sapn>
										</div>
									</div>
									<hr>
									<label>For best experience, please wait ~20 seconds before select samples. Click + for more filtering options.</label>
									<div class="row m-n" id="auto_search">
										<div class="col-lg-4 diseaseNameSelect" style="padding: 0 5px;">
											<a class="casePlusAddFilter m-r-xs m-l-sm" style="margin-top: 8px;"><i class="fa fa-plus-square" aria-hidden="true"></i></a>
											<label class="formFild" style="margin-top:10px; margin-left: 18px;" for="case_disease_name">Disease Name</label>
											<input type="text" id="hidden-data" value="1" style="display:none;">
										</div>
										<div class="col-lg-8" style="padding-right:0px;">
											{% if job %}
												<!--<input type="text" id="case_disease_name" name="case_disease_name" value="{{ job.jobs.0.disease_name }}" class="diseasecasefilter form-control formFild" style="height:25px" data-column-index="7" required >-->
											{% else %}
												<!--<input type="text" id="case_disease_name" name="case_disease_name" value="" class="diseasecasefilter form-control formFild" style="height:25px" data-column-index="7" required >-->

												<!--START: Code to create the Disease Dropdown List-->
												<select id="ourCustomSelect" placeholder="Select Disease Name" multiple="multiple" name="case_disease_name" class="testselect2"></select>
												<input id="getDiseaseName" name="our_disease_list" class="form-control" style="display:none;" value="" type="text">
												<!--END: Code to create the Disease Dropdown List-->

											{% endif %}

										</div>
										<div class="row">
											<div  class="col-lg-12">
												<div id="caseAddFilter"></div>
											</div>
										</div>
										<div class="row">
											<div  class="col-lg-12">
												<a id="caserefbt" class="btn btn-blue m-t-xs pull-right" style="float: right; margin-left: 1%;"><i class=""></i> Reset Features</a>
												<!-- <a id="casebt" class="btn btn-blue m-t-xs pull-right" style="float: right;"><i class="fa fa-filter"></i> Filter Samples</a> -->
											</div>
										</div>
									</div>

									<div class="row m-n" id="manual_search_case" style="display:none;">
										<div class="col-lg-6 diseaseNameSelect" style="padding: 0px 35px;">
											<label class="formFild" style="margin-top:10px; margin-left: 18px;">Enter Case Sample ID's</label>
										</div>
										<div class="col-lg-6" style="padding-right:0px;">
											<textarea class="form-control" id="manual_sample_case_id" name="manual_sample_case_id" rows="10"></textarea>
										</div>

										<!--<div class="row">-->
											<!--<div  class="col-lg-12">-->
												<!--<a id="validate_case_id" class="btn btn-blue m-t-xs pull-right" style="float: right; margin-left: 1%;"><i class=""></i> Validate Case Sample ID's</a>-->
											<!--</div>-->
										<!--</div>-->
									</div>

									<!--<div class="row">-->
										<!--<div  class="col-lg-12">-->
											<!--<a id="caserefbt" class="btn btn-blue m-t-xs pull-right" style="float: right; margin-left: 1%;"><i class=""></i> Reset Features</a>-->
											<!--&lt;!&ndash; <a id="casebt" class="btn btn-blue m-t-xs pull-right" style="float: right;"><i class="fa fa-filter"></i> Filter Samples</a> &ndash;&gt;-->
										<!--</div>-->
									<!--</div>-->
								</div>
							</div>

							<div class="col-sm-5">
								{% if job %}
									<textarea class="form-control" style="display:none;" id="case_samples" name="case_samples">{{ job.jobs.0.case_sample_id }}</textarea>
								{% else %}
									<textarea class="form-control" style="display:none;" id="case_samples" name="case_samples"></textarea>
                                {% endif %}
								<!--<input type="button" id="case_refresh" class="btn btn-blue pull-right m-t-xs" style="display:none;" value="Refresh Chart">-->
							</div>

						</div>

						<div class="row" id="casesamplemaindiv">
							<div class="col-lg-12">
								<hr>
								<h3 style="color:#000">Available/Selected Case Samples</h3>

								<table id="caseSample" class="table table-striped table-bordered display nowrap select" style="width:100%">
									<thead>
										 <tr>
											<th style="text-align: center;"></th>
											<th>More Info</th>
											<th>Sample Id</th>
											<th>Type</th>
											<th>Age</th>
											<th>Site</th>
											<th>Gender</th>
											<th>Metastatic Site</th>
											<th>Cancer</th>
											<th>EGFR</th>
											<th>IDH1</th>
											<th>IDH2</th>
											<th>TP53</th>
											<th>Tumor Grade</th>
											<th>Tumor Stage</th>
											 <th>Mutation</th>
											 <th>Gain</th>
											 <th>Loss</th>
										</tr>
									</thead>
									<tbody></tbody>
								</table>
							</div>
						</div>

						<!--<div class="row">-->
							<!--<div class="col-lg-12">-->
								<!--<div class="ibox ">-->
									<!--<div class="ibox-title" style="background: #009ece; color: white;">-->
										<!--<h5 class="pull-left">Up Signature Genes</h5>-->
									<!--</div>-->
									<!--<div class="ibox-content">-->
										<!--<div class="row">-->
											<!--<div class="col-lg-12">-->
											<!--<div class="ibox ">-->
												<!--<div class="ibox-title">-->
													<!--<h5 class="pull-left">Up Signature Genes</h5>-->
												<!--</div>-->
												<!--<div class="ibox-content">-->
													<!--<table id="dg_dzUpSigGenesCsv" class="table table-striped table-bordered display" cellspacing="0"  width="100%">-->
													<!--<thead>-->
														<!--<tr>-->
															<!--<th class="nowrap">Database</th>-->
															<!--<th style="word-wrap: break-word;">Category</th>-->
															<!--<th>Pval</th>-->
															<!--<th>Qval</th>-->
															<!--<th class="nowrap">Combined Score</th>-->
															<!--<th style="word-wrap: break-word;">Genes</th>-->
														<!--</tr>-->
													<!--</thead>-->
													<!--<tbody></tbody>-->
												<!--</table>-->
												<!--</div>-->
											<!--</div>-->
											<!--</div>-->
										<!--</div>-->
									<!--</div>-->
								<!--</div>-->
							<!--</div>-->
						<!--</div>-->

						<!--<div class="row">-->
							<!--<div class="col-lg-12">-->
								<!--<div class="ibox ">-->
									<!--<div class="ibox-title" style="background: #009ece; color: white;">-->
										<!--<h5 class="pull-left">Down Signature Genes</h5>-->
									<!--</div>-->
									<!--<div class="ibox-content">-->
										<!--<div class="row">-->
											<!--<div class="col-lg-12">-->
											<!--<div class="ibox ">-->
												<!--<div class="ibox-title">-->
													<!--<h5 class="pull-left">Down Signature Genes</h5>-->
												<!--</div>-->
												<!--<div class="ibox-content">-->
													<!--<table id="dg_dzDownSigGenesCsv" class="table table-striped table-bordered display" cellspacing="0"  width="100%">-->
													<!--<thead>-->
														<!--<tr>-->
															<!--<th class="nowrap">Database</th>-->
															<!--<th class="nowrap">Category</th>-->
															<!--<th style="word-wrap: break-word;">Pval</th>-->
															<!--<th style="word-wrap: break-word;">Qval</th>-->
															<!--<th class="nowrap">Combined Score</th>-->
															<!--<th class="nowrap">Genes</th>-->
														<!--</tr>-->
													<!--</thead>-->
													<!--<tbody></tbody>-->
												<!--</table>-->
												<!--</div>-->
											<!--</div>-->
											<!--</div>-->
										<!--</div>-->
									<!--</div>-->
								<!--</div>-->
							<!--</div>-->
						<!--</div>-->

						<!--<div class="row">-->
							<!--<div class="col-lg-12">-->
								<!--<div class="ibox ">-->
									<!--<div class="ibox-title" style="background: #009ece; color: white;">-->
										<!--<h5 class="pull-left">Approved Drugs</h5>-->
									<!--</div>-->
									<!--<div class="ibox-content">-->
										<!--<div class="row">-->
											<!--<div class="col-lg-12">-->
											<!--<div class="ibox ">-->
												<!--<div class="ibox-title">-->
													<!--<h5 class="pull-left">Approved Drugs</h5>-->
												<!--</div>-->
												<!--<div class="ibox-content">-->
													<!--<table id="dg_dzApprovedDrugsCsv" class="table table-striped table-bordered display" cellspacing="0"  width="100%">-->
													<!--<thead>-->
														<!--<tr>-->
															<!--<th class="nowrap">Pert Iname</th>-->
															<!--<th class="nowrap">Clinical Phase</th>-->
															<!--<th class="nowrap">Moa</th>-->
															<!--<th class="nowrap">Target</th>-->
															<!--<th class="nowrap">sRGES</th>-->
														<!--</tr>-->
													<!--</thead>-->
													<!--<tbody></tbody>-->
												<!--</table>-->
												<!--</div>-->
											<!--</div>-->
											<!--</div>-->
										<!--</div>-->
									<!--</div>-->
								<!--</div>-->
							<!--</div>-->
						<!--</div>-->
					</fieldset>
<!--*************************************** 2. contro -->
					<h1>Control</h1>
					<fieldset>
						<div class="row m-b-xs">
							<div class="col-lg-7">
								<div class="form-group">
									<div class="row m-n" id="control_auto_manual_option">
										<div class="col-lg-2">
											<span>
												<input type="radio" id="auto_control" name="control_selection" value="auto_control" checked="">
												<i></i> Auto
											</span>
										</div>
										<div class="col-lg-3" style="display:none;" >
											<sapn>
												<input type="radio" id="manual_control" name="control_selection" value="manual_control">
												<i></i> Manual
											</sapn>
										</div>
									</div>
									<hr>
									<div class="row m-n" id="manual_search_control" style="display:none;">
										<div class="col-lg-6" style="padding: 0px 35px;">
											<label class="formFild" style="margin-top:10px; margin-left: 18px;">Enter Control Sample ID's</label>
										</div>
										<div class="col-lg-6" style="padding-right:0px;">
											<textarea class="form-control" id="manual_sample_control_id" name="manual_sample_control_id" rows="10"></textarea>
										</div>

										<div class="row">
										<div class="col-lg-12"  >
												<a id="validate_control_id" class="btn btn-blue m-t-xs pull-right" style="float: right; margin-left: 1%;"><i class=""></i> Validate Control Sample ID's</a>
											</div>
										</div>
									</div>

									<div id="controlAddFilter"></div>

									<!--<div class="row m-n">-->
										<!--<div id="bt" class="col-sm-12" style="padding-right:0px;">-->
										<!--<a id="controlrefbt" class="btn btn-blue m-l-xs" href="#" style="float:right;margin-left:1%;"><i class=""></i> Reset Features</a>-->
											<!--&lt;!&ndash; <a id="controlbt" class="btn btn-blue m-l-xs" href="#" style="float:right;"><i class="fa fa-filter"></i> Filter Samples</a> &ndash;&gt;-->
										<!--</div>-->
									<!--</div>-->

								</div>
							</div>

							<div class="col-lg-5">
							 	{% if job %}
									<textarea class="form-control" style="display:none;" id="control_samples" name="control_samples">{{ job.jobs.0.ctrl_sample_id }}</textarea>
								{% else %}
									<textarea class="form-control" style="display:none;" id="control_samples" name="control_samples"></textarea>
                                {% endif %}
                                <a class="btn btn-blue pull-right m-l-xs" id="job_compute_popup">Compute Control Samples</a>

								<!--<input type="button" id="control_refresh" class="btn btn-blue pull-right" style="display:none;" value="Refresh Chart">-->
							</div>
						</div>

                        <div id="correlation_graph_div" style="display: none;">
                            <div class="row">
                                <div class="col-lg-12">
                                    <iframe id="correlationGraphImg" style="width:100%;height:740px;" src=""></iframe>
                                </div>
                            </div>
                        </div>


						<div class="row" id="controlSampleDiv" style="display:none;">
							<div class="col-lg-12">
								<hr>
								<h3 style="color:#000">Available/Selected Control Samples</h3>

								<table id="controlSample" class="table table-striped table-bordered display nowrap" style="width:100%">
									<thead>
										 <tr>
											<th style="text-align: center;"></th>
											<th>More Info</th>
											<th>Sample Id</th>
											<th>Type</th>
											<th>Age</th>
											<th>Site</th>
											<th>Gender</th>
											<th>Metastatic Site</th>
											<th>Cancer</th>
											<th>EGFR</th>
											<th>IDH1</th>
											<th>IDH2</th>
											<th>TP53</th>
											<th>Tumor Grade</th>
											<th>Tumor Stage</th>
										</tr>
									</thead>
									<tbody></tbody>
								</table>

							</div>
						</div>

					</fieldset>
<!--*************************************** 3. Signature -->
					<h1>Signature</h1>
					<fieldset>
						<div class="row">
							<div class="form-group">

								<div class="col-sm-3">
									<select class="searchBoxSign" id="de_method" name="de_method">
										{% if job and job.status >= 3 and job.jobs.0.de_method == 'edgeR' %}
											<option value="edgeR" selected>edgeR</option>
											<option value="limma" disabled>Limma</option>
										{% elif job and job.status >= 3 and job.jobs.0.de_method == 'limma' %}
											<option value="edgeR">edgeR</option>
											<option value="limma" selected disabled>Limma</option>
										{% else %}
											<option value="edgeR" selected>edgeR</option>
											<option value="limma" >Limma</option> {# re-enabled limma option PBills, IT Services #}
										{% endif %}

									</select>
								</div>
								<div class="col-sm-9">
									<div class="form-group pull-left col-sm-4">
										<label class="col-lg-6 control-label text-right m-t-xs" >Adjusted P</label>
	                                    <div class="col-lg-6">
											{% if job and job.status >= 3 %}
												<input type="text" id="dz_p_threshold" name="dz_p_threshold" Placeholder="0.001" value="{{ job.jobs.0.dz_p_threshold}}" class="form-control" style="height:30px;">
											{% else %}
	                                    		<input type="text" id="dz_p_threshold" name="dz_p_threshold" Placeholder="0.001" value="0.001" class="form-control" style="height:30px;">
											{% endif %}
											<p align="center"><b>*Note:</b> Please enter values in float e.g 0.001</p>
                                    	</div>
									</div>
									<div class="form-group pull-left col-sm-6">
										<label class="col-lg-8 control-label text-right m-t-xs">Minimum Fold Change Threshold</label>
	                                    <div class="col-lg-4">
											{% if job and job.status >= 3 %}
	                                    		<input type="text" Placeholder="2" value="{{ job.jobs.0.dz_fc_threshold}}" id="dz_fc_threshold" name="dz_fc_threshold" class="form-control" style="height:30px;">
											{% else %}
	                                    		<input type="text" Placeholder="2" value="2" id="dz_fc_threshold" name="dz_fc_threshold" class="form-control" style="height:30px;">
											{% endif %}
                                    	</div>
									</div>
									<div class="form-group pull-left col-sm-2">
										<!-- <a class="btn btn-blue pull-right m-l-xs" href="#" disabled>Advanced</a> -->
										<a class="btn btn-blue pull-right m-l-xs" id="job_compute">View Signature</a>
									</div>
								</div>
							</div>
						</div>
						 <div id="Signature-loader" style="height : 330px;display : none;">
                                    <img src="/static/img/ajax-loader.gif" style="margin: 15% 10% 10% 48%">
                          </div>
						<div id="SignatureDiv" style="display: none;">
							<div class="row">
								<div class="col-lg-12">
									<iframe id="signatureImg" style="width:93%;height:740px;" src=""></iframe>
								</div>
							</div>
							<div class="row" id="dz_enricher"></div>

							<div class="row">
								<div class="col-lg-12">
									<div class="ibox ">
										<div class="ibox-title" style="background: #009ece; color: white;">
											<h5 class="pull-left">Disease Signature</h5>
										</div>
										<div class="ibox-content">
											<div class="row">
												<div class="col-lg-12">
												<div class="ibox ">
													<div class="ibox-title">
														<h5 class="pull-left">Disease Signature</h5>
													</div>
													<div class="ibox-content">
														<table id="dg_dzSignCsv" class="table table-striped table-bordered display" cellspacing="0"  width="100%">
														<thead>
															<tr>
																<th class="nowrap">Identifier</th>
																<th class="nowrap">Gene</th>
																<th style="word-wrap: break-word;">log2FoldChange</th>
																<th class="nowrap">padj</th>
															</tr>
														</thead>
														<tbody></tbody>
													</table>
													</div>
												</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>

							<div class="row">
								<div class="col-lg-12">
									<div class="ibox ">
										<div class="ibox-title" style="background: #009ece; color: white;">
											<h5 class="pull-left">Up Signature Genes</h5>
										</div>
										<div class="ibox-content">
											<div class="row">
												<div class="col-lg-12">
												<div class="ibox ">
													<div class="ibox-title">
														<h5 class="pull-left">Up Signature Genes</h5>
													</div>
													<div class="ibox-content">
														<table id="dg_dzUpSigGenesCsv" class="table table-striped table-bordered display" cellspacing="0"  width="100%">
														<thead>
															<tr>
																<th class="nowrap">Database</th>
																<th style="word-wrap: break-word;">Category</th>
																<th>Odds Ratio</th>
																<th>Qval</th>
																<th class="nowrap">Combined Score</th>
																<th style="word-wrap: break-word;">Genes</th>
															</tr>
														</thead>
														<tbody></tbody>
													</table>
													</div>
												</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>

							<div class="row">
								<div class="col-lg-12">
									<div class="ibox ">
										<div class="ibox-title" style="background: #009ece; color: white;">
											<h5 class="pull-left">Down Signature Genes</h5>
										</div>
										<div class="ibox-content">
											<div class="row">
												<div class="col-lg-12">
												<div class="ibox ">
													<div class="ibox-title">
														<h5 class="pull-left">Down Signature Genes</h5>
													</div>
													<div class="ibox-content">
														<table id="dg_dzDownSigGenesCsv" class="table table-striped table-bordered display" cellspacing="0"  width="100%">
														<thead>
															<tr>
																<th class="nowrap">Database</th>
																<th class="nowrap">Category</th>
																<th style="word-wrap: break-word;">Odds Ratio</th>
																<th style="word-wrap: break-word;">Qval</th>
																<th class="nowrap">Combined Score</th>
																<th class="nowrap">Genes</th>
															</tr>
														</thead>
														<tbody></tbody>
													</table>
													</div>
												</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>



					</fieldset>

<!--*************************************** 4. drug -->
					<h1>Drugs</h1>
					<fieldset class="form-p-3">
						<div class="drugContainer">
							<div class="row">
								<div class="col-lg-12">
									<div class="i-checks pull-left m-t-xs">
										<label>
											<input type="radio" name="database" value="lincs_db" checked="checked">
											<i></i> LINCS database
										</label>
									</div>
								</div>
							</div>

							<div class="row">
								<div class="form-group">
									<div class="col-sm-3">
										<select class="searchBoxDrugs" name="account">
											<option value="0">Select Database</option>
											<option value="L1000" selected>L1000</option>
											<option value="L10002" disabled>L1000 All</option>
										</select>
									</div>

									<!--<div class="col-sm-9">-->
										<!--<div class="i-checks pull-left m-t-xs">-->
											<!--<label>-->
												<!--<input type="checkbox" value="F" group="linc_flag" id="weight_cell_line" name="weight_cell_line">-->
												<!--<i></i> Weight Cell Line-->
											<!--</label>-->
										<!--</div>-->
										<!--<div class="i-checks pull-left m-t-xs m-l-sm">-->
											<!--<label>-->
												<!--<input type="checkbox" value="F" group="linc_flag" id="keep_lineage" name="keep_lineage">-->
												<!--<i></i> Keep Same Lineage-->
											<!--</label>-->
										<!--</div>-->
									<!--</div>-->
									<div class="col-sm-9">
										<div class="row">
											<div class="i-checks pull-left m-t-xs">
												<label style="color: #999C9E;">
													<input type="checkbox" value="F" group="linc_flag" id="weight_cell_line" name="weight_cell_line" disabled>
													<i></i> Weight Cell Line (coming soon)
												</label>
											</div>
										</div><div class="row">
											<div class="i-checks pull-left m-t-xs">
												<label style="color: #999C9E;">
													<input type="checkbox" value="F" group="linc_flag" id="keep_lineage" name="keep_lineage" disabled>
													<i></i> Keep Same Lineage (coming soon)
												</label>
											</div>
										</div>
										<div class="row">
											<div class="i-checks pull-left m-t-xs">
												<label>
													<input type="checkbox" value="F" group="linc_flag" id="drugAvailable" name="drugAvailable">
													<i></i> Include an additional results file which shows only FDA approved drugs
												</label>
											</div>
										</div>
									</div>
								</div>
							</div>

							<!--<div class="row">-->
								<!--<div class="form-group">-->
									<!--<div class="col-sm-3">-->
										<!--<input type="text" value="input" class="form-control" style="visibility:hidden;">-->
									<!--</div>-->

									<!--<div class="col-sm-9">-->
										<!--<div class="i-checks pull-left m-t-xs">-->
											<!--<label>-->
												<!--<input type="checkbox" value="F" group="linc_flag" id="drugAvailable" name="drugAvailable">-->
												<!--<i></i> Drug Clincal Available-->
											<!--</label>-->
										<!--</div>-->
									<!--</div>-->
								<!--</div>-->
							<!--</div>-->

							<div class="row m-t-xs">
								<div class="form-group">
									<label class="col-lg-3 control-label text-right m-t-sm">Max up-regulated genes and max down-regulated genes</label>
									<div class="col-lg-2">
										<input type="text" value="50" placeholder="50" id="lincs_max_genes" name="lincs_max_genes" class="form-control" style="width:100px;margin-top: 13px;">
									</div>
									<div class="col-lg-5" style="margin-left: -71px;top: 21px;">
										<span>Ex: Choosing 50 means 50 up &amp; 50 down, so 100 total max.</span>
									</div>
								</div>
							</div>
						</div>
						<!--up
						<div class="drugContainer">
							<div class="row">
								<div class="col-lg-12">
									<div class="i-checks pull-left m-t-xs">
										<label>
											<input type="radio" name="database" value="cmap_db">
											<i></i> CMap Database
										</label>
									</div>
								</div>
							</div>

							<div class="row">
								<div class="form-group">
									<label class="col-lg-3 control-label text-right m-t-sm">Max Genes on One Side</label>
									<div class="col-lg-9">
										<input type="text" Placeholder="150" id="cmap_max_genes" name="cmap_max_genes" class="form-control" style="width:100px;">
									</div>
								</div>
							</div>
						</div>

						-->
					</fieldset>
				</form>
					<!-- <a class="btn btn-primary m-l-xs saveBtn" href="#" style="float:right;">Save</a> -->

					<!--  save Popup  -->
					<div class="modal inmodal" id="saveInfo" tabindex="-1" role="dialog" aria-hidden="true">
                        <div class="modal-dialog">
                        	<div class="modal-content">
                                <div class="modal-header">
                                	<h3 class="pull-left">Save Job</h3>
                                    <button type="button" class="close pull-right" data-dismiss="modal">
                                    	<span aria-hidden="true">&times;</span>
                                    	<span class="sr-only">Close</span>
                                   	</button>
                                </div>
								<form id="saveJob" action="{{ url_for('dashboard.save_job') }}" method="POST">
									<div class="modal-body">
										<div class="form-group">
											<label>Job Name<span style="color:red;">*</span></label>
											{% if job %}
											<input type="text" name="jobName" placeholder="Job Name" value="{{ job.name }}" class="form-control" TABINDEX=1 required>
											<!-- note job_id input is present on parent form, which is concatenated to this form on submit -->
											{% else %}
											<input type="text" id="job_name" name="jobName" placeholder="Job Name" class="form-control" TABINDEX=1 required>
											{% endif %}
										</div>
										<div class="form-group">
											<label>Description (optional)</label>
											{% if job %}
											<textarea name="description" placeholder="Description" class="form-control" TABINDEX=2>{{ job.description }} </textarea>
											{% else %}
											<textarea name="description" id="description" placeholder="Description" class="form-control" TABINDEX=2></textarea>
											{% endif %}
										</div>
										{% if g.user %}
										<input type="hidden" id="save_form_user_id" name="user_id" value="false">
										<div class="form-group">
											<p>Saving for account : {{ g.user }}</p>
										</div>
										{% endif %}
										<input type="hidden" id="finishInfo" name="finishInfo" value="false">
										<input type="hidden" id="next_url" name="next_url" value="false">
									</div>
									<div class="modal-footer">
										<button id="savenproceed" type="button" class="btn btn-primary">Save & Proceed</button>
										<!--<button type="button" class="btn btn-white" data-dismiss="modal" style=""  id="cancelJob">Don't Save</button>-->
										<button type="button" class="btn btn-white" data-dismiss="modal">Don't Save</button>
										<button type="button" class="btn btn-white" data-dismiss="modal">Cancel</button>
									</div>
								</form>
                            </div>
                        </div>
                    </div>
                    <!--  save Popup  -->

					
					<!--  Summary Popup  -->
					<div class="modal inmodal" id="summaryInfo" tabindex="-1" role="dialog" aria-hidden="true">
                        <div class="modal-dialog">
                        	<div class="modal-content">
                                <div class="modal-header">
                                	<h3 class="pull-left">Job Summary</h3>
                                    <button type="button" class="close pull-right" data-dismiss="modal">
                                    	<span aria-hidden="true">&times;</span>
                                    	<span class="sr-only">Close</span>
                                   	</button>
                                </div>
                                <div class="modal-body p-xs">
                                	<div class="row m-n">
										<div class="col-lg-12" style="padding:0;">
											<div class="ibox m-b-sm">
												<div class="ibox-title p-xs" style="min-height:auto;">
													<h5>Case</h5>
													<div class="ibox-tools">
														<a class="collapse-link">
															<i class="fa fa-chevron-up"></i>
														</a>
													</div>
												</div>
			                            		<div id="caseFilterContainer" class="ibox-content">

												</div>
											</div>
										</div>

										<div class="col-lg-12" style="padding:0;">
											<div class="ibox border-bottom m-b-sm">
												<div class="ibox-title p-xs" style="min-height:auto;">
													<h5>Control</h5>
													<div class="ibox-tools">
														<a class="collapse-link">
															<i class="fa fa-chevron-down"></i>
														</a>
													</div>
												</div>
			                         			<div id="controlFilterContainer" class="ibox-content" style="display:none;">

												</div>
											</div>
										</div>

										<div class="col-lg-12" style="padding:0;">
											<div class="ibox border-bottom m-b-sm">
												<div class="ibox-title p-xs" style="min-height:auto;">
													<h5>Signature</h5>
													<div class="ibox-tools">
														<a class="collapse-link">
															<i class="fa fa-chevron-down"></i>
														</a>
													</div>
												</div>
			                            	<div id="signatureFilterContainer" class="ibox-content" style="display:none;">

												</div>
											</div>
										</div>

										<div class="col-lg-12" style="padding:0;">
											<div class="ibox border-bottom m-b-sm">
												<div class="ibox-title p-xs" style="min-height:auto;">
													<h5>Drugs</h5>
													<div class="ibox-tools">
														<a class="collapse-link">
															<i class="fa fa-chevron-down"></i>
														</a>
													</div>
												</div>
			                            	<div id="drugsFilterContainer" class="ibox-content" style="display:none;">

												</div>
											</div>
										</div>

									</div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--  save Popup  -->

					<!-- START : Compute Reference Popup  -->
					<div class="modal inmodal" id="computeRefInfo" tabindex="-1" role="dialog" aria-hidden="true">
                        <div class="modal-dialog">
                        	<div class="modal-content">
                                <div class="modal-header">
                                	<h3 class="pull-left">Compute Reference</h3>
                                    <button type="button" class="close pull-right" data-dismiss="modal">
                                    	<span aria-hidden="true">&times;</span>
                                    	<span class="sr-only">Close</span>
                                   	</button>
                                </div>
								<form id="computeControlSamples" method="POST">
									<div class="modal-body p-xs">
										<div class="row m-n">
											<div class="col-lg-12" style="padding:0;">
												<div class="ibox m-b-sm">
													<div class="ibox-title p-xs" style="/* min-height:auto; */">
														<div class="i-checks pull-left">
															<label class="m-r-sm">
                                                                <input type="checkbox" name="control_tissue_type" class="check controlfilter1" group="controlTissueType1" data-column-index="2" id="checkbox1" value="" checked>
																<!--<input type="checkbox" checked="" name="control_tissue_type" group="controlType" value="" class="controlfilter" data-column-index="2">-->
																<i></i>adjacent
															</label>
														</div>
													</div>
													<div id="caseFilterContainer11" class="ibox-content">
														<i></i>How many Control Samples? :
														<input type="text" id="setControlDataCnt" name="control_size" value="50" style="width: 48px;text-align: center;">
													</div>
												</div>
											</div>
										</div>
										<div class="modal-footer">
											<input id="setComputeRef" class="form-control" style="display:none;" value="0" type="text">
											<button id="btnApplyCompute" type="button" class="btn btn-primary">Apply</button>
											<button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
                    <!-- END : Compute Reference Popup  -->
        	</div>
		</div>
        {% include 'base/footer.html' %}

    </div>

    {% include 'base/js_links.html' %}


    <script type="text/javascript">

		var flag = 0;
		var site = '';
		var cnrow_count = 0;
		var caseTable;
		var controlTable;
		var case_tp53 = new Array();
		var case_gender = new Array();
		var case_idh1 = new Array();
		var case_tissue_types = new Array();
		var case_egfr = new Array();
		var case_sites = new Array();
		var case_grades = new Array();
		var case_metastatics = new Array();
		var case_idh2 = new Array();
		var case_stages = new Array();
		var features_data = {};

		var contol_tp53 = new Array();
		var contol_gender = new Array();
		var contol_idh1 = new Array();
		var contol_tissue_types = new Array();
		var contol_egfr = new Array();
		var contol_sites = new Array();
		var contol_grades = new Array();
		var contol_metastatics = new Array();
		var contol_idh2 = new Array();
		var contol_stages = new Array();
		var contol_age = new Array();
		var control_features_data = {};

		$('#setControlDataCnt').keyup(function(){
			if( $('#setControlDataCnt').val() < 2 || $('#setControlDataCnt').val() > 1000 ) {
				swal("Please enter value between 2 and 1000");
			}
		});

		$('#btnApplyCompute').click(function(){

			$("#setComputeRef").val(1);

			$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div><span style="color:black;">Computing Control Samples, it might take couple of minutes..</span>' });

		    var checkedIds = $(".check:checked").map(function() {
                return this.id;
            }).toArray();

            var control_tissue_type;
            if( checkedIds == 'checkbox1' ) {
                control_tissue_type = 'true';
            } else {
                control_tissue_type = 'false';
            }

            var job_id = $("#job_id").val();
            var control_size = $("#setControlDataCnt").val();

			$.ajax({
				url: "/diseases1",
				type: "POST",
				dataType: "json",
				data : JSON.stringify({ "job_id" : job_id, "control_size" : control_size, "control_tissue_type" : control_tissue_type }),
				success: function (result) {
					loadControlTable2(result)
					$("#correlation_graph_div").show();
                    $("#correlationGraphImg").attr('src', result['correlation_graph'])
					swal("Control Samples Computed Successfully.");
					$.unblockUI();
				}
			});
			$("#computeRefInfo").modal('hide');
		});

		function loadControlTable2(result)
		{

			if(result.samples.length > 0){

				if( $.fn.dataTable.isDataTable("#controlSample") ) {
					var controlTable = $('#controlSample').DataTable();
					controlTable.clear().draw();

					controlTable.rows.add(result.samples).select(); // Add new data
					controlTable.draw(); // Redraw the DataTable

				} else {
					var controlTable = $('#controlSample').DataTable({
						data: result.samples,
						"lengthMenu": [[5, 25, 50, -1], [5, 25, 50, "All"]],
						"ordering" : false,
						"searching" : true,
						"columnDefs": [
							{
							'targets': 0,
							'checkboxes': {
								   'selectRow': true
								},
								'searchable': false,
								'orderable': false,
								'className': 'select-checkbox',
							},
							{
								"className":"details-control",
								"orderable":false,
								"data":null,
								"defaultContent": '',
								"width": "10px",
								targets : 1
							},
							{
								"targets": [ 4 ],
								"visible": false
							},
							{
								"targets": [ 6 ],
								"visible": false
							},
							{
								"targets": [ 9 ],
								"visible": false
							},
							{
								"targets": [ 10 ],
								"visible": false
							},{
								"targets": [ 11 ],
								"visible": false
							},
							{
								"targets": [ 12 ],
								"visible": false
							},
							{
								"targets": [ 13 ],
								"visible": false
							},
							{
								"targets": [ 14 ],
								"visible": false
							}
						],
						"select": {
							"style": 'multi',
							"selector": 'td:first-child'
						},
						"order": [[1, 'asc']]
					});

					var rows = $("#controlSample").dataTable().$('tr', {"filter":"applied"});
					controlTable.rows(rows).select();
				}

				$.each(result.samples, function(i, item){
					if ($.inArray(item[3], contol_tissue_types)<0){
						contol_tissue_types.push(item[3])
					}
					if ($.inArray(item[5], contol_sites)<0){
						contol_sites.push(item[5])
					}
					if ($.inArray(item[6], contol_gender)<0){
						contol_gender.push(item[6])
					}
					if ($.inArray(item[7], contol_metastatics)<0){
						contol_metastatics.push(item[7])
					}
					if ($.inArray(item[9], contol_egfr)<0){
						contol_egfr.push(item[9])
					}
					if ($.inArray(item[10], contol_idh1)<0){
						contol_idh1.push(item[10])
					}
					if ($.inArray(item[11], contol_idh2)<0){
						contol_idh2.push(item[11])
					}
					if ($.inArray(item[12], contol_tp53)<0){
						contol_tp53.push(item[12])
					}
					if ($.inArray(item[13], contol_grades)<0){
						contol_grades.push(item[13])
					}
					if ($.inArray(item[14], contol_stages)<0){
						contol_stages.push(item[14])
					}
				});
				control_features_data = result;
				control_features_data.tp53 = contol_tp53;
				control_features_data.gender = contol_gender;
				control_features_data.idh1 = contol_idh1;
				control_features_data.tissue_types = contol_tissue_types;
				control_features_data.egfr = contol_egfr;
				control_features_data.sites = contol_sites;
				control_features_data.grades = contol_grades;
				control_features_data.metastatics = contol_metastatics;
				control_features_data.idh2 = contol_idh2;
				control_features_data.stages = contol_stages;
			}

			<!--if (result.site != ''){-->
				<!--if ($("#control_select_1").length<1){-->
					<!--$(".controlPlusAddFilter").trigger('click');-->

					<!--site = 'brain - amygdala'-->
					<!--$("#control_select_1")[0].sumo.selectItem('Site')-->
					<!--$("#controlcolsm_1 select[name=control_site]")[0].sumo.selectItem(site);-->
					<!--$("#controlminus_row_1").hide();-->
					<!--$("#control_plus_static row").hide();-->
				<!--}-->
			<!--}-->
		}

		function dgGetPageCount() {
			$("#pageCount").remove();
			var res = $(".select-item").text().split(" ");
			var mdata = '<span id="pageCount" style="color: red;float: left; font-size: 10px;margin: 14px 17px;"><b>Warning:</b> Using very few samples will result in a less robust disease signature and may negatively impact your results! Proceed with caution or increase sample size. Note that selecting the check box besides More Info on the table above allows to select all samples.</span>';
			//alert("inside : " + res[0]);
			if( res[0] == '' || parseInt(res[0]) <= 10 ) {
				$(".actions.clearfix").append( mdata );
			} else {
				$("#pageCount").remove();
			}
		}

		function dgResetDataTable() {
			disease_name = $("#getDiseaseName").val();
			for (var i = 2; i <= 17; i++) {
			  caseTable.columns(i).search('');
			}
			caseTable.columns(8).search("^" + disease_name + "$", true, false, true);
		}

		// Checkbox change function
		function caseFilter(){
			caseTable = $('#caseSample').DataTable();
			jsonObj = {}; // key as column number and value as list of OR values

			$('.casefilter').each(function(){

				$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });
				setTimeout($.unblockUI, 1000);

				<!-- START : Code for Mutation to reset the apply filter -->
				$('.dg_caseMutationFilter').each(function(){
					$("#pageCount").remove();
					$("select.dg_caseMutationFilter").change(function(){
						dgResetDataTable();
					});
				});
				<!-- END : Code for Mutation to reset the apply filter -->

				<!-- START : Code for Gain to reset the apply filter -->
				$('.dg_caseGainFilter').each(function(){
					$("#pageCount").remove();
					$("select.dg_caseGainFilter").change(function(){
						dgResetDataTable();
					});
				});
				<!-- END : Code for Gain to reset the apply filter -->

				<!-- START : Code for Loss to reset the apply filter -->
				$('.dg_caseLossFilter').each(function(){
					$("#pageCount").remove();
					$("select.dg_caseLossFilter").change(function(){
						dgResetDataTable();
					});
				});
				<!-- END : Code for Loss to reset the apply filter -->

				<!-- START : Code for Tumor Grade to reset the filter -->
				$('.dg_caseTumorGradeFilter').each(function(){
					$("#pageCount").remove();
					$("select.dg_caseTumorGradeFilter").change(function(){
						if($(this).val() == "" ) {
							disease_name = '';
							caseTable.columns(8).search("^" + disease_name + "$", true, false, true);
						} else {
							dgResetDataTable();
						}
					});
				});
				<!-- END : Code for Tumor Grade to reset the filter -->

				<!-- START : Code for Tumor Stage to reset the apply filter -->
				$('.dg_caseTumorStageFilter').each(function(){
					$("#pageCount").remove();
					$("select.dg_caseTumorStageFilter").change(function(){
						if($(this).val() == "" ) {
							disease_name = '';
							caseTable.columns(8).search("^" + disease_name + "$", true, false, true);
						} else {
							dgResetDataTable();
						}
					});
				});
				<!-- END : Code for Tumor Stage to reset the filter -->

				<!-- START : Code for Site to reset the filter -->
				$('.dg_caseSiteFilter').each(function(){
					$("#pageCount").remove();
					$("select.dg_caseSiteFilter").change(function(){
						if($(this).val() == "" ) {
							disease_name = '';
							caseTable.columns(8).search("^" + disease_name + "$", true, false, true);
						} else {
							dgResetDataTable();
						}
					});
				});
				<!-- END : Code for Site to reset the filter -->

				<!-- START : Code for Metastatic Site to reset the filter -->
				$('.dg_caseMetastaticFilter').each(function(){
					$("#pageCount").remove();
					$("select.dg_caseMetastaticFilter").change(function(){
						if($(this).val() == "" ) {
							disease_name = '';
							caseTable.columns(8).search("^" + disease_name + "$", true, false, true);
						} else {
							dgResetDataTable();
						}
					});
				});
				<!-- END : Code for Metastatic Site to reset the filter -->

				<!-- START : Code for Gender to reset the filter -->
				$('.dg_caseGenderFilter').each(function(){
					$("#pageCount").remove();
					$("select.dg_caseGenderFilter").change(function(){
						if($(this).val() == "" ) {
							disease_name = '';
							caseTable.columns(8).search("^" + disease_name + "$", true, false, true);
						} else {
							dgResetDataTable();
						}
					});
				});
				<!-- END : Code for Gender to reset the filter -->

				<!-- START : Code for Tissue Type to reset the filter -->
				$('.dg_caseTissueTypeFilter').each(function(){
					$("#pageCount").remove();
					$("select.dg_caseTissueTypeFilter").change(function(){
						if($(this).val() == "" ) {
							disease_name = '';
							caseTable.columns(8).search("^" + disease_name + "$", true, false, true);
						} else {
							dgResetDataTable();
						}
					});
				});
				<!-- END : Code for Tissue Type to reset the filter -->


			    if(this.value.trim() == ""){}
				else{
					//alert($(this).data('columnIndex'));

					if ($(this).data('columnIndex') == 2 ){
						<!--if(this.checked){-->
							<!--if(jsonObj.hasOwnProperty("3")){-->
								<!--jsonObj["3"].push(this.value)-->
							<!--}-->
							<!--else{-->
								<!--jsonObj = {"3": new Array(this.value)}-->
							<!--}-->
						<!--}-->
						<!--else{-->
							<!--if(jsonObj.hasOwnProperty("3")){-->
								<!--jsonObj["3"].push("")-->
							<!--}-->
							<!--else{-->
								<!--jsonObj = {"3": new Array("")}-->
							<!--}-->
						<!--}-->

						<!-- START : Feature for the Tissue Type -->

						var tissueTypeList = [];
						$.each($(".dg_caseTissueTypeFilter option:selected"), function(){
							tissueTypeList.push($(this).val());
						});
						var strTissueTypeList = tissueTypeList.join("|");
						caseTable.columns(3).search("^" + strTissueTypeList + "$", true, false, true);

						<!-- END : Feature for the Tissue Type -->

					} else if ($(this).data('columnIndex') == 4){

						<!-- START : Feature for the Site -->

						var siteList = [];
						$.each($(".dg_caseSiteFilter option:selected"), function(){
							siteList.push($(this).val());
						});
						var strSiteList = siteList.join("|");
						caseTable.columns(5).search("^" + strSiteList + "$", true, false, true);

						<!-- END : Feature for the Site-->

						<!--caseTable.columns(5).search(this.value);-->
					} else if ($(this).data('columnIndex') == 5){
						<!--if(this.checked){-->
							<!--caseTable.columns(6).search("^"+this.value+"$", true);-->
						<!--}-->

						<!-- START : Feature for the Gender -->

						var genderList = [];
						$.each($(".dg_caseGenderFilter option:selected"), function(){
							genderList.push($(this).val());
						});
						var strGenderList = genderList.join("|");
						caseTable.columns(6).search("^" + strGenderList + "$", true, false, true);

						<!-- END : Feature for the Gender -->

					} else if ($(this).data('columnIndex') == 6){

						<!-- START : Feature for the Metastatic Site -->

						var metastaticSiteList = [];
						$.each($(".dg_caseMetastaticFilter option:selected"), function(){
							metastaticSiteList.push($(this).val());
						});
						var strMetastaticSiteList = metastaticSiteList.join("|");
						caseTable.columns(7).search("^" + strMetastaticSiteList + "$", true, false, true);

						<!-- END : Feature for the Metastatic Site -->
						<!--caseTable.columns(7).search(this.value);-->
					} else if ($(this).data('columnIndex') == 7){
						caseTable.columns(8).search(this.value);
					} else if ($(this).data('columnIndex') == 8){
						if (this.checked){
							caseTable.columns(9).search(this.value);
						}
					} else if ($(this).data('columnIndex') == 9){
						if (this.checked){
							caseTable.columns(10).search(this.value);
						}
					} else if ($(this).data('columnIndex') == 10){
						if (this.checked){
							caseTable.columns(11).search(this.value);
						}
					} else if ($(this).data('columnIndex') == 11){
						if (this.checked){
							caseTable.columns(12).search(this.value);
						}
					} else if ($(this).data('columnIndex') == 12){

						<!-- START : Feature for the Tumor Grade -->

						var tumorGradeList = [];
						$.each($(".dg_caseTumorGradeFilter option:selected"), function(){
							tumorGradeList.push($(this).val());
						});
						var strTumorGradeList = tumorGradeList.join("|");
						caseTable.columns(13).search("^" + strTumorGradeList + "$", true, false, true);

						<!-- END : Feature for the Tumor Grade -->

					} else if ($(this).data('columnIndex') == 13){

						<!-- START : Feature for the Tumor Stage -->

						var tumorStageList = [];
						$.each($(".dg_caseTumorStageFilter option:selected"), function(){
							tumorStageList.push($(this).val());
						});
						var strTumorStageList = tumorStageList.join("|");
						$("#getCaseTumorStageName").val(strTumorStageList);
						caseTable.columns(14).search("^" + strTumorStageList + "$", true, false, true);

						<!-- END : Feature for the Tumor Stage -->
					} else if ($(this).data('columnIndex') == 15){

						<!-- START : Feature for the Mutation -->

						var mutationList = [];
						$.each($(".dg_caseMutationFilter option:selected"), function(){
							mutationList.push($(this).val());
						});
						var strMutationList = mutationList.join("|");
						$("#getCaseMutationName").val(strMutationList);
						caseTable.columns(15).search(strMutationList, true, false, true);

						<!-- END : Feature for the Mutation -->
					} else if ($(this).data('columnIndex') == 16){

						<!-- START : Feature for the Gain -->

						var gainList = [];
						$.each($(".dg_caseGainFilter option:selected"), function(){
							gainList.push($(this).val());
						});
						var strGainList = gainList.join("|");
						$("#getCaseGainName").val(strGainList);
						caseTable.columns(16).search(strGainList, true, false, true);

						<!-- END : Feature for the Gain -->
					} else if ($(this).data('columnIndex') == 17){

						<!-- START : Feature for the Loss -->

						var lossList = [];
						$.each($(".dg_caseLossFilter option:selected"), function(){
							lossList.push($(this).val());
						});
						var strLossList = lossList.join("|");
						$("#getCaseLossName").val(strLossList);
						caseTable.columns(17).search(strLossList, true, false, true);

						<!-- END : Feature for the Loss -->
					}
				}
			});

			$.each(jsonObj, function(key,value) {
				search_data = value.join("|");
				search_data = value.filter(function (val) {return val;}).join("|");
				var i = parseInt(key);
				caseTable.columns(i).search(search_data, true);
			});

			caseTable.rows('.selected').deselect();
			caseTable.draw();
			var rows = $("#caseSample").dataTable().$('tr', {"filter":"applied"});
			caseTable.rows(rows).select();
			//case_plot();
		}


		function controlFilter(){

			controlTable = $('#controlSample').DataTable();
			jsonObj = {}; // key as column number and value as list of OR values
			$('.controlfilter').each(function(){
				if(this.value.trim() == ""){}
				else{
					if ($(this).data('columnIndex') == 2 ){
						if(this.checked){
							if(jsonObj.hasOwnProperty("3")){
								jsonObj["3"].push(this.value)
							}
							else{
								jsonObj = {"3": new Array(this.value)}
							}
						}
						else{
							if(jsonObj.hasOwnProperty("3")){
								jsonObj["3"].push("")
							}
							else{
								jsonObj = {"3": new Array("")}
							}
						}
					} else if ($(this).data('columnIndex') == 4){
						controlTable.columns(5).search(this.value);
					} else if ($(this).data('columnIndex') == 5){
						if(this.checked){
							controlTable.columns(6).search("^"+this.value+"$", true);
						}

					} else if ($(this).data('columnIndex') == 6){
						controlTable.columns(7).search(this.value);
					} else if ($(this).data('columnIndex') == 8){
						if (this.checked){
							controlTable.columns(9).search(this.value);
						}
					} else if ($(this).data('columnIndex') == 9){
						if (this.checked){
							controlTable.columns(10).search(this.value);
						}
					} else if ($(this).data('columnIndex') == 10){
						if (this.checked){
							controlTable.columns(11).search(this.value);
						}
					} else if ($(this).data('columnIndex') == 11){
						if (this.checked){
							controlTable.columns(12).search(this.value);
						}
					} else if ($(this).data('columnIndex') == 12){
						controlTable.columns(13).search(this.value);
					} else if ($(this).data('columnIndex') == 13){
						controlTable.columns(14).search(this.value);
					}
				 }
			});

			$.each(jsonObj, function(key,value) {
				search_data = value.join("|");
				var i = parseInt(key);
				controlTable.columns(i).search(search_data, true);
			});

			controlTable.rows('.selected').deselect();
			controlTable.draw();
			$.unblockUI();
			var rows = $("#controlSample").dataTable().$('tr', {"filter":"applied"});
			controlTable.rows(rows).select();
			//control_plot()
		}


<!--START: Filter value is NOT EMPTY-->

		$(document).on('change','.casefilter',function(){
			if(this.id == "case_disease_name" || $(this).val() =="Select Grade" || $(this).val() =="Select Metastatics" || $(this).val() =="Select Site"){

			} else {

				<!-- START : Check filter value is EMPTY or NOT -->
				caseTable = $('#caseSample').DataTable();
				$('.dg_caseTissueTypeFilter').each(function(){
					if($(".dg_caseTissueTypeFilter").val() == "" ) {
						disease_name = '';
						caseTable.columns(8).search("^" + disease_name + "$", true, false, true);
					}
				});
				$('.dg_caseSiteFilter').each(function(){
					if($(".dg_caseSiteFilter").val() == "" ) {
						disease_name = '';
						caseTable.columns(8).search("^" + disease_name + "$", true, false, true);
					}
				});
				$('.dg_caseMetastaticFilter').each(function(){
					if($(".dg_caseMetastaticFilter").val() == "" ) {
						disease_name = '';
						caseTable.columns(8).search("^" + disease_name + "$", true, false, true);
					}
				});
				$('.dg_caseTumorStageFilter').each(function(){
					if($(".dg_caseTumorStageFilter").val() == "" ) {
						disease_name = '';
						caseTable.columns(8).search("^" + disease_name + "$", true, false, true);
					}
				});
				$('.dg_caseTumorGradeFilter').each(function(){
					if($(".dg_caseTumorGradeFilter").val() == "" ) {
						disease_name = '';
						caseTable.columns(8).search("^" + disease_name + "$", true, false, true);
					}
				});
				<!-- END : Check filter value is EMPTY or NOT -->

				caseFilter();
				dgGetPageCount();
				<!--var res = $(".select-item").text().split(" ");-->
				<!--alert(res[0]);-->


				<!--if( parseInt(res[0]) >= 10 ) {-->
					<!--$("#pageCount").remove();-->
				<!--}-->
			}
		});


		$(document).on('change','.controlfilter',function(){
			if(this.id == "case_disease_name" || $(this).val() =="Select Grade" || $(this).val() =="Select Metastatics" || $(this).val() =="Select Site"){

			} else {
				controlFilter();
			}
		});




		$(document).ready(function(){


			$("#form").show()

			$("#page-loader").show()

			// added P. Bills, IT Services May 2020, options to use account or anonymous for saving job
			// this enables/disables id/password fields in save form (modal)
			// based on checkbox.   

			// force initial state of this form (some browsers remember checkbox state)
			$("#save_modal_use_email_checkbox").prop('checked',false);
			$("#save_modal_email_input").prop("disabled", true);
			$("#save_modal_password_input").prop("disabled", true);

			$("#save_modal_use_email_checkbox").change(function () {
				if ($(this).is(":checked")) {
					$("#save_modal_email_input").prop("disabled", false);
					$("#save_modal_password_input").prop("disabled", false);
				} else {
					$("#save_modal_email_input").prop("disabled", true);
					$("#save_modal_password_input").prop("disabled", true);
				}
			});
			
			$('#savenproceed').on('click', function() {

				if( $("#job_name").val() == '' ) {
					swal("Please provide job name.");
					return;
				}

				var jobData = $("#form").serializeArray();
				//console.log("jobData : "+ jobData);

				var formData = $("#saveJob").serializeArray();
				var allData = formData.concat(jobData)
				var formUrl = $("#saveJob")[0].action;
				job_id = $("#job_id")[0].value;
				//disease = $("#case_disease_name").val()
				disease = $("#getDiseaseName").val();
				if (disease.length < 0){
					swal("Please provide disease name then filter sample and select samples.");
					return false;
				} else{
					$.post(formUrl, allData, function(result){
						$("#saveInfo").modal('hide');
						var next_url = result['next_url'];
						var finishInfo = result['finishInfo'];						
						swal(result['category'])
						 if (next_url && result['category'] == 'success'){
							$("#job_id")[0].value = result['job_id'];
							swal(result['message'])

							if (next_url != 'false'){
								location.href = next_url
							}
							if (finishInfo == 'true'){
								// location.href = "{{ url_for('dashboard.job_history') }}"
								// this is changed to the actual single job output view (even if there isn't any)
								// to accommodate anonymous jobs, ie users who have not logged-in, there is no job history
								location.href = result['finished_url'];
							}
						}
						else{
							 swal(result['message']);
						}
					}, "json")
				}

			});

			function caseTableLoad() {
				$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });
				$('#casesamplemaindiv').css("display","none");
				$('#caseSample').DataTable({
					"ajax": "{{ url_for('api.sampleApi1') }}",    
					"lengthMenu": [[5, 25, 50, -1], [5, 25, 50, "All"]],
					"ordering" : false,
					"searching" : true,
					"columnDefs": [
						{
							'targets': 0,
							'checkboxes': {
							   'selectRow': true
							},
							'searchable': false,
							'orderable': false,
							'className': 'select-checkbox',
						},
						{
							"className":"details-control",
							"orderable":false,
							"data":null,
							"defaultContent": '',
							"width": "10px",
							targets : 1
						},
						{
							"targets": [ 4 ],
							"visible": false
						},
						{
							"targets": [ 6 ],
							"visible": false
						},
						{
							"targets": [ 9 ],
							"visible": false
						},
						{
							"targets": [ 10 ],
							"visible": false
						},{
							"targets": [ 11 ],
							"visible": false
						},
						{
							"targets": [ 12 ],
							"visible": false
						},
						{
							"targets": [ 13 ],
							"visible": false
						},
						{
							"targets": [ 14 ],
							"visible": false
						},
						{
							"targets": [ 15 ],
							"visible": false
						},
						{
							"targets": [ 16 ],
							"visible": false
						},
						{
							"targets": [ 17 ],
							"visible": false
						}
					],
					"select": {
						"style": 'multi',
						"selector": 'td:first-child'
					},
					"order": [[1, 'asc']]
				});

                //$.unblockUI();
                //$("#casebt").trigger('click'); // Comment this because on load disease is not selected.
                //caseFilter();
                //case_plot();

                $.ajax({
                    url: "/diseases",
                    type: "GET",
                    dataType: "json",
                    success: function (data) {

						<!--START : Code to create the Disease Dropdown List-->

                    	var result = '';
						$.each( data, function( key, value ) {
							result = result +'<option value="'+value.replace(/['"]+/g, '')+'">'+value.replace(/['"]+/g, '')+'</option>';
						});
						$("#ourCustomSelect").append(result);
						$(".testselect2").SumoSelect({search: true, searchText:'Enter here.' });

						var count = 0;

						var last_valid_selection = null;
						$("select.testselect2").change(function(){
							$("#pageCount").remove();
							$('#casesamplemaindiv').css("display","block");
							var diseasesList = [];
							if ($(this).val().length > 5) {
								swal('You can only choose 5!');
								var $this = $(this);
								$this[0].sumo.unSelectAll();
								$.each(last_valid_selection, function (i, e) {
									$this[0].sumo.selectItem($this.find('option[value="' + e + '"]').index());
								});
							} else {

								$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });
								setTimeout($.unblockUI, 2000);

								last_valid_selection = $(this).val();
								$.each($(".testselect2 option:selected"), function(){
									diseasesList.push($(this).val());
								});
								var strDiseaseList = diseasesList.join("|");
								//alert(strDiseaseList);
								$("#getDiseaseName").val(strDiseaseList);
								var disease = $(this).val();

								<!--if ($(this).data('columnIndex') == 7){-->
									var caseTable = $('#caseSample').DataTable();
									caseTable.rows('.selected').deselect();
									caseTable.draw();
									<!--caseTable.columns(8).search(strDiseaseList, true, false).draw();-->
									caseTable.columns(8).search("^" + strDiseaseList + "$", true, false, true).draw();
									var rows = $("#caseSample").dataTable().$('tr', {"filter":"applied"});
									if( disease == '' ) {
										$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });
										setTimeout($.unblockUI, 2000);
										var rows = '';
										caseTable.rows(rows).select();
										$('#casesamplemaindiv').css("display","none");
									} else {
										var rows = $("#caseSample").dataTable().$('tr', {"filter":"applied"});
										caseTable.rows(rows).select();
									}
								<!--}-->
								case_tp53 = []; case_gender =[]; case_idh1 = []; case_tissue_types = []; case_egfr =[]; case_sites = [];case_grades = []; case_metastatics =[]; case_idh2 = []; case_stages = []; case_mutation_list = []; case_gain_list = []; case_loss_list = [];  case_age_in_yr = [];
								$.ajax({
									url: "{{ url_for('api.get_casefeature_by_disease') }}",
									type: "POST",
									contentType: 'application/json',
									data : JSON.stringify({"disease": disease }),
									async: false
								}).done(function (result) {
									/*var data = jQuery.parseJSON(result)*/
									features_data = jQuery.parseJSON(result)
									case_tp53 = features_data.tp53;
									case_gender = features_data.gender;
									case_idh1 = features_data.idh1;
									case_tissue_types = features_data.tissue_types;
									case_egfr = features_data.egfr;
									case_sites = features_data.sites;
									case_grades = features_data.grades;
									case_metastatics = features_data.metastatics;
									case_idh2 = features_data.idh2;
									case_stages = features_data.stages;
									case_mutation_list = features_data.mutation_list
									case_gain_list = features_data.gain_list
									case_loss_list = features_data.loss_list
									<!--case_age_in_yr = features_data.age_in_year-->
									//case_plot()
								});
							}
							dgGetPageCount(); // get the Page Count of searched disease
						});

						<!--END: Code to create the Disease Dropdown List-->


                    	$("#case_disease_name").autocomplete({
                            source: data,
                            minLength: 3,
                            select: function(event, ui){
                            	$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });
                                var disease = ui.item.value;
                                if (disease.length>0){
                                    if ($(this).data('columnIndex') == 7){
                                        var caseTable = $('#caseSample').DataTable();
                                        caseTable.rows('.selected').deselect();
                                        caseTable.draw();
                                        caseTable.columns(8).search(disease).draw();
                                        var rows = $("#caseSample").dataTable().$('tr', {"filter":"applied"});
                                        caseTable.rows(rows).select();
                                    }
                                    case_tp53 = []; case_gender =[]; case_idh1 = []; case_tissue_types = []; case_egfr =[]; case_sites = [];case_grades = []; case_metastatics =[]; case_idh2 = []; case_stages = [];
                                    $.ajax({
										url: "{{ url_for('api.get_casefeature_by_disease') }}",
										type: "POST",
										contentType: 'application/json',
										data : JSON.stringify({"disease": disease }),
										async: false
									}).done(function (result) {
										/*var data = jQuery.parseJSON(result)*/
										features_data = jQuery.parseJSON(result)
										case_tp53 = features_data.tp53;
										case_gender = features_data.gender;
										case_idh1 = features_data.idh1;
										case_tissue_types = features_data.tissue_types;
										case_egfr = features_data.egfr;
										case_sites = features_data.sites;
										case_grades = features_data.grades;
										case_metastatics = features_data.metastatics;
										case_idh2 = features_data.idh2;
										case_stages = features_data.stages;
										//case_plot()
									});
                                }
                            }
                        });
                        $.unblockUI();
                    }
                });

			}

			function loadControlTable(job_id, data){
				var file_name = data;
				$.ajax({
					url: "{{ url_for('api.controlSampleApi1') }}",
					type: "POST",
					contentType: 'application/json',
  					data : JSON.stringify({"file_name": file_name, "job_id": job_id}, null, '\t'),
  					async : false
				}).done(function (result) {
					if(result.length > 0){
						var obj = JSON.parse(result);

						if( $.fn.dataTable.isDataTable("#controlSample") ) {
							var controlTable = $('#controlSample').DataTable();
						} else {
							var controlTable = $('#controlSample').DataTable({
								data: obj['samples'],
								"lengthMenu": [[5, 25, 50, -1], [5, 25, 50, "All"]],
								"ordering" : false,
								"searching" : true,
								"columnDefs": [
									{
									'targets': 0,
									'checkboxes': {
										   'selectRow': true
										},
										'searchable': false,
										'orderable': false,
										'className': 'select-checkbox',
									},
									{
										"className":"details-control",
										"orderable":false,
										"data":null,
										"defaultContent": '',
										"width": "10px",
										targets : 1
									},
									{
										"targets": [ 4 ],
										"visible": false
									},
									{
										"targets": [ 6 ],
										"visible": false
									},
									{
										"targets": [ 9 ],
										"visible": false
									},
									{
										"targets": [ 10 ],
										"visible": false
									},{
										"targets": [ 11 ],
										"visible": false
									},
									{
										"targets": [ 12 ],
										"visible": false
									},
									{
										"targets": [ 13 ],
										"visible": false
									},
									{
										"targets": [ 14 ],
										"visible": false
									}
								],
								"select": {
									"style": 'multi',
									"selector": 'td:first-child'
								},
								"order": [[1, 'asc']]
							});
						}

						$.each(obj['samples'], function(i, item){
							if ($.inArray(item[3], contol_tissue_types)<0){
								contol_tissue_types.push(item[3])
							}
							if ($.inArray(item[5], contol_sites)<0){
								contol_sites.push(item[5])
							}
							if ($.inArray(item[6], contol_gender)<0){
								contol_gender.push(item[6])
							}
							if ($.inArray(item[7], contol_metastatics)<0){
								contol_metastatics.push(item[7])
							}
							if ($.inArray(item[9], contol_egfr)<0){
								contol_egfr.push(item[9])
							}
							if ($.inArray(item[10], contol_idh1)<0){
								contol_idh1.push(item[10])
							}
							if ($.inArray(item[11], contol_idh2)<0){
								contol_idh2.push(item[11])
							}
							if ($.inArray(item[12], contol_tp53)<0){
								contol_tp53.push(item[12])
							}
							if ($.inArray(item[13], contol_grades)<0){
								contol_grades.push(item[13])
							}
							if ($.inArray(item[14], contol_stages)<0){
								contol_stages.push(item[14])
							}
						});
						control_features_data = obj;
						control_features_data.tp53 = contol_tp53;
						control_features_data.gender = contol_gender;
						control_features_data.idh1 = contol_idh1;
						control_features_data.tissue_types = contol_tissue_types;
						control_features_data.egfr = contol_egfr;
						control_features_data.sites = contol_sites;
						control_features_data.grades = contol_grades;
						control_features_data.metastatics = contol_metastatics;
						control_features_data.idh2 = contol_idh2;
						control_features_data.stages = contol_stages;
					}
					var rows = $("#controlSample").dataTable().$('tr', {"filter":"applied"});
					controlTable.rows(rows).select();

					if (file_name != null && obj['site'] != ''){
						if ($("#control_select_1").length<1){
							$(".controlPlusAddFilter").trigger('click');

							site = obj['site']
							$("#control_select_1")[0].sumo.selectItem('Site')
							$("#controlcolsm_1 select[name=control_site]")[0].sumo.selectItem(site);
							$("#controlminus_row_1").hide();
							$("#control_plus_static row").hide();
						}
					}
				   //control_plot();
				});
			}



			var $stopChanging = false;

			$("#form").steps({
				bodyTag: "fieldset",
				labels: {finish: "Submit"},
				{% if job and (job.status == 0 or job.status == 1) %}
				startIndex: 0,
				{% elif job and (job.status == 2 or job.status == 3) %}
					startIndex: 1,
				{% elif job and job.status == 4%}
					startIndex: 2,
				{% elif job and job.status == 5%}
					startIndex: 3,
				{% else %}
					startIndex: 0,
				{% endif %}

				onInit: function (event, currentIndex, newIndex){

					<!--var jobId = $("#job_id")[0].value;-->
					<!--var jobId = 123;-->
					<!--loadSingnatureCsv(jobId);-->
					<!--loadUpSignatureCsv(jobId);-->
					<!--loadDownSignatureCsv(jobId);-->
					<!--loadApprovedDrugsCsv(jobId);-->
					<!--loadMutationCsv(jobId);-->
					<!--loadGainCsv(jobId);-->
					<!--loadLossCsv(jobId);-->

					caseForm();
					controlForm();
					caseTableLoad();
					$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });
					//setTimeout($.unblockUI, 2000);
					var saveA = $("<a>").attr("href","#").attr("id","saveBtn").text("Save");
					saveA.on('click', function(){
						job_id = $("#job_id")[0].value;
						//disease = $("#case_disease_name").val()
						disease = $("#getDiseaseName").val();
						if (disease.length > 0){
							$("#saveInfo").modal('show');
						}
						else{
							swal("Please provide disease name then filter sample and select samples.");
						}
					});
					var saveBtn = $("<li>").attr("aria-disabled",false).append(saveA);
					$(document).find(".actions ul").prepend(saveBtn);

					// summary Button
					var summaryA = $("<a>").attr("href","#").attr("data-toggle","modal").attr("data-target","#summaryInfo").attr("id","summaryBtn").text("Summary");
					var summaryBtn = $("<li>").attr("aria-disabled",false).append(summaryA);
					$(document).find(".actions ul").prepend(summaryBtn)

					$("#job_compute_popup").click(function(){
						$("#computeRefInfo").modal('show');
					});

					/* START : Code for the Radio Button on Control Page */

					$("#manual_control").click(function(){

						$("#manual_search_control").css('display','block');
						$("#job_compute_popup").css('display','none');


						<!--$("#manual_control_id").attr('disabled', false);-->
						<!--$("#validate_control_id").attr('disabled', false);-->
						<!--$("#job_compute_popup").css('pointer-events', 'none');-->
						<!--$("#job_compute_popup").attr('disabled', true);-->
					});

					$("#auto_control").click(function(){

						$("#manual_search_control").css('display','none');
						$("#job_compute_popup").css('display','block');

						<!--$("#manual_control_id").attr('disabled', true);-->
						<!--$("#validate_control_id").attr('disabled', true);-->
						<!--$("#job_compute_popup").css('pointer-events', 'auto');-->
						<!--$("#job_compute_popup").attr('disabled', false);-->
					});

					/* END : Code for the Radio Button on Control Page */



					$("#summaryBtn").click(function(){
						var selectTags = $("select[name='feature']")
						var controlselectTags = $("select[name='cfeature']")
						$("#caseFilterContainer").html('');
						$("#controlFilterContainer").html('');
						$("#signatureFilterContainer").html('');
						$("#drugsFilterContainer").html('');
						 var str = '';
						 var cstr = '';

						 str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">Disease Name</label><label class="col-lg-8"><b>'+$("#getDiseaseName").val()+'</b></label></div>';

						$.each(selectTags, function(index){
							filterSelectVal = selectTags[index].value
							id = selectTags[index].id
							row_id = id.split('_')[2];


						if(filterSelectVal == 'Tissue Type')
						{
							var ctype = [];
							$.each($("input[name='case_type']:checked"), function(){
										ctype.push($(this).val());
							});
							str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8"><b>'+$('select[name="case_tissue_type"]').val()+'</b></label></div>';
						}
						else if(filterSelectVal == 'Site')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8"><b>'+$('select[name="case_site"]').val()+'</b></label></div>';
						}
						else if(filterSelectVal == 'Gender')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8"><b>'+$('select[name="case_gender"]').val()+'</b></label></div>';
						}
						else if(filterSelectVal == 'Metastatic Site')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8"><b>'+$('select[name="case_metastatic"]').val()+'</b></label></div>';
						}
						else if(filterSelectVal == 'EGFR')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8"><b>'+$("#EGFRcasecheck").is(':checked')+'</b></label></div>';
						}
						else if(filterSelectVal == 'IDH1')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8"><b>'+$("#IDH1casecheck").is(':checked')+'</b></label></div>';
						}
						else if(filterSelectVal == 'IDH2')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8"><b>'+$("#IDH2casecheck").is(':checked')+'</b></label></div>';
						}
						else if(filterSelectVal == 'TP53')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8"><b>'+$("#TP53casecheck").is(':checked')+'</b></label></div>';
						}
							else if(filterSelectVal == 'Age')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8"><b>'+$("#caseAgeDisplay").val()+'</b></label></div>';
						}

						else if(filterSelectVal == 'Tumor Grade')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8"><b>'+$('select[name="case_tumor_grade"]').val()+'</b></label></div>';
						}
						else if(filterSelectVal == 'Tumor Stage')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8"><b>'+$('select[name="case_tumor_stage"]').val()+'</b></label></div>';
						}
						else if(filterSelectVal == 'Mutation')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8" style="word-wrap: break-word;"><b>'+$("#getCaseMutationName").val().replace(/;/g, "")+'</b></label></div>';
						}
						else if(filterSelectVal == 'Gain')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8" style="word-wrap: break-word;"><b>'+$("#getCaseGainName").val().replace(/;/g, "")+'</b></label></div>';
						}
						else if(filterSelectVal == 'Loss')
						{
							  str = str + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8" style="word-wrap: break-word;"><b>'+$("#getCaseLossName").val().replace(/;/g, "")+'</b></label></div>';
						}
						})
						$("#caseFilterContainer").append(str);

						$.each(controlselectTags, function(index){
							cfilterSelectVal = controlselectTags[index].value
							id = controlselectTags[index].id
							row_id = id.split('_')[2];

						if(cfilterSelectVal == 'Tissue Type')
						{
						 var ctype = [];
						 $.each($("input[name='control_type']:checked"), function(){
										ctype.push($(this).val());
								 });
								  cstr = cstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+cfilterSelectVal+'</label><label class="col-lg-8"><b>'+ctype.toString()+'</b></label></div>';
						}
						else if(cfilterSelectVal == 'Site')
						{

							  cstr = cstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+cfilterSelectVal+'</label><label class="col-lg-8"><b>'+$('select[name="control_site"]').val()+'</b></label></div>';
						}
						else if(cfilterSelectVal == 'Gender')
						{

							  cstr = cstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+cfilterSelectVal+'</label><label class="col-lg-8"><b>'+$('input[name=control_gender]:checked').val()+'</b></label></div>';
						}
						else if(cfilterSelectVal == 'Metastatic Site')
						{

							  cstr = cstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+cfilterSelectVal+'</label><label class="col-lg-8"><b>'+$('select[name="control_metastatic"]').val()+'</b></label></div>';
						}
						else if(cfilterSelectVal == 'EGFR')
						{

							  cstr = cstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+cfilterSelectVal+'</label><label class="col-lg-8"><b>'+$("#EGFRcontcheck").is(':checked')+'</b></label></div>';
						}
						else if(cfilterSelectVal == 'IDH1')
						{

							  cstr = cstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+cfilterSelectVal+'</label><label class="col-lg-8"><b>'+$("#IDH1contcheck").is(':checked')+'</b></label></div>';
						}
						else if(cfilterSelectVal == 'IDH2')
						{

							  cstr = cstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+cfilterSelectVal+'</label><label class="col-lg-8"><b>'+$("#IDH2contcheck").is(':checked')+'</b></label></div>';
						}
						else if(cfilterSelectVal == 'TP53')
						{

							  cstr = cstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+cfilterSelectVal+'</label><label class="col-lg-8"><b>'+$("#TP53contcheck").is(':checked')+'</b></label></div>';
						}
							else if(cfilterSelectVal == 'Age')
						{

							  cstr = cstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+cfilterSelectVal+'</label><label class="col-lg-8"><b>'+$("#controlAgeDisplay").val()+'</b></label></div>';
						}

						else if(cfilterSelectVal == 'Tumor Grade')
						{

							  cstr = cstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+filterSelectVal+'</label><label class="col-lg-8"><b>'+$('select[name="control_tumor_grade"]').val()+'</b></label></div>';
						}
						else if(cfilterSelectVal == 'Tumor Stage')
						{

							  cstr = cstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">'+cfilterSelectVal+'</label><label class="col-lg-8"><b>'+$('select[name="control_tumor_stage"]').val()+'</b></label></div>';
						}
						})
						$("#controlFilterContainer").append(cstr);


						var sigstr = '';
						if($("#de_method").val() != "0")
							sigstr = sigstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">DE method</label><label class="col-lg-8"><b>'+$("#de_method").val()+'</b></label></div>';

						if($("#dz_p_threshold").val() != "")
							sigstr = sigstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">Adjusted P</label><label class="col-lg-8"><b>'+$("#dz_p_threshold").val()+'</b></label></div>';
						if($("#dz_fc_threshold").val() != "")
							sigstr = sigstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">Fold Change</label><label class="col-lg-8"><b>'+$("#dz_fc_threshold").val()+'</b></label></div>';

						$("#signatureFilterContainer").append(sigstr);

						var sstr= '';
						var dbselectde = $('input[name=database]:checked').val();
						if(dbselectde == 'lincs_db')
						{
							if($('select[name="account"]').val() != "0")
								sstr = sstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">Account</label><label class="col-lg-8"><b>'+$('select[name="account"]').val()+'</b></label></div>';

							if($("input[name='weight_cell_line']").is(':checked'))
								sstr = sstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">Weight Cell Line</label><label class="col-lg-8"><b>'+$("input[name='weight_cell_line']").is(':checked')+'</b></label></div>';

							if($("input[name='keep_lineage']").is(':checked'))
								sstr = sstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">Keep Same Lineage</label><label class="col-lg-8"><b>'+$("input[name='keep_lineage']").is(':checked')+'</b></label></div>';

							if($("input[name='drugAvailable']").is(':checked'))
								sstr = sstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">Drug Clincal Available</label><label class="col-lg-8"><b>'+$("input[name='drugAvailable']").is(':checked')+'</b></label></div>';

							if($("#lincs_max_genes").val() != "")
								sstr = sstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">Max Genes on One Side</label><label class="col-lg-8"><b>'+$("#lincs_max_genes").val()+'</b></label></div>';

						}
						else {
							if($("#cmap_max_genes").val() != "")
								sstr = sstr + '<div class="form-group row bordrBtm"><label class="col-lg-4 text-info">Max Genes on One Side</label><label class="col-lg-8"><b>'+$("#cmap_max_genes").val()+'</b></label></div>';
						}
						$("#drugsFilterContainer").append(sstr);
					})

					if (currentIndex >= 0 ){
					}
					if (currentIndex >= 1 ){
					}
					if (currentIndex >= 2 ){
					}

				},

				onStepChanging: function (event, currentIndex, newIndex){
					$stopChanging = false;
					<!--$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });-->
					<!--setTimeout($.unblockUI, 2000);-->
					if ($stopChanging) {
						return true;
					} else {
						//alert(newIndex);
						if (newIndex == 0){
							$("#saveBtn").show();
							$("#setComputeRef").val(0);
						} else if (newIndex == 1){
							$("#saveBtn").show();
							//disease_name = $("#case_disease_name")[0].value.trim();
							//disease_name = $("#ourCustomSelect").val();

							disease_name = $("#getDiseaseName").val();

							var job_id = $("#job_id")[0].value;

							if($('input[name=case_selection]:checked').val() == 'manual_case' ) {
								var sample_case_id = $("#manual_sample_case_id").val();

								if( sample_case_id != '' ) {

									var strSampleCaseIdList = sample_case_id.replace( /\n/g, "|" ).split( " " );
									var caseTable = $('#caseSample').DataTable();
									caseTable.columns(2).search("^" + strSampleCaseIdList + "$", true, false, true).draw();

									var intSampleTotalCount = $("#manual_sample_case_id").val().split("\n").length;
									var resCount = $("#caseSample_info").text().split(" ");

									if(intSampleTotalCount-resCount[5] > 0 ) {
										swal("You have entered some wrong Sample ID");
										$("#form").steps("previous");
									    return false;
									} else {
										var url = "{{ url_for('dashboard.job_case', disease='manual_case') }}"
										$.ajax({
											url: url,
											type: "POST",
											contentType: 'application/json',
											data : JSON.stringify({"job_id": job_id, "case_samples": sample_case_id }),
											dataType:'json',
											async: false
										}).done(function (data) {
											//$.unblockUI();
											$("#job_id")[0].value = data.job_id;

											if (data.file_name == "fail"){
												$("#form").steps("previous");
											}else{
												swal("Case samples successfully created.");
												$stopChanging = true;
												//loadControlTable(data.job_id, data.file_name)

												<!--var table = $("#controlSample").dataTable();-->
												<!--var controlDataCnt = table.fnGetData().length;-->
												<!--$("#setControlDataCnt").val(controlDataCnt);-->

												$('#manual_control').prop('checked', true);
												$("#job_compute_popup").css('display','none');
												$("#manual_search_control").css('display','block');
												$("#auto_control").attr("disabled",true);
											}
										}).fail(function (jqXHR, textStatus) {
											 //$.unblockUI();
											$("#form").steps("previous");
										});
									}

								} else {
									swal("Please enter the Case Sample ID's");
									$("#form").steps("previous");
									return false;
								}
							} else {
								if (disease_name.length>0){
									var res = $(".select-item").text().split(" ");
									if( res[0] == '' || parseInt(res[0]) <= 2 ) {
										swal("Using less than 2 samples is not currently supported. Please include more samples before proceeding.");
										return false;
									} else {

										$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });
										setTimeout($.unblockUI, 2000);

										// ADD case samples selected in data table.....
										var case_str = '';
										var rows = $("#caseSample").dataTable().$('tr', {"filter":"applied", "selected": true});
										case_ids = $('#caseSample').DataTable().rows(rows).data();
										if (case_ids.length>0){
											case_str = ''
											for (var i=0; i < case_ids.length ;i++){
												case_str = case_str + case_ids[i][2] + ','
											}
										}
										$("#case_samples").val(case_str);

										//$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> <span style="color:black;">Filtering control samples....</span>' });
										var url = "{{ url_for('dashboard.job_case', disease='abc') }}"
										url = url.replace('abc', disease_name);
										$.ajax({
											url: url,
											type: "POST",
											contentType: 'application/json',
											data : JSON.stringify({"job_id": job_id, "case_samples": $("#case_samples").val() }),
											dataType:'json',
											async: false
										}).done(function (data) {
											//$.unblockUI();
											$("#job_id")[0].value = data.job_id;

											if (data.file_name == "fail"){
												$("#form").steps("previous");
											}else{
												$stopChanging = true;
												//loadControlTable(data.job_id, data.file_name)

												<!--var table = $("#controlSample").dataTable();-->
												<!--var controlDataCnt = table.fnGetData().length;-->
												<!--$("#setControlDataCnt").val(controlDataCnt);-->
											}
										}).fail(function (jqXHR, textStatus) {
											 //$.unblockUI();
											$("#form").steps("previous");
										});
									}
								} else {
									if(disease_name.length==0)
										swal("Please select disease name")
									else if(job_id != undefined || job_id != '')
										swal("Please select samples")
									$("#form").steps("previous");
									return false;
								}
							}

						} else if (newIndex == 2){
							//$stopChanging = true;

							job_id = $("#job_id")[0].value;

							if($('input[name=case_selection]:checked').val() == 'manual_case' ) {
							    var computeurl = "/job/manual_check";
                                $.ajax({
                                    url: computeurl,
                                    type: "POST",
                                    contentType: 'application/json',
                                    data : JSON.stringify({"job_id": job_id}),
                                    dataType:'json'
                                }).done(function (data) {


                                });
								$("#form").steps("next");
								return;
							} else {
								if( $("#setComputeRef").val() == '0' ) {
									swal("Please click Compute Control Samples before proceeding");
									return;
								} else {
									$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });
									setTimeout($.unblockUI, 2000);
									$("#saveBtn").show();
									// ADD control samples selected in data table.....
									var control_str = '';
									var rows = $("#controlSample").dataTable().$('tr', {"filter":"applied", "selected": true});
									control_ids = $('#controlSample').DataTable().rows(rows).data();
									if (control_ids.length>0){
										control_str = ''
										for (var i=0; i < control_ids.length ;i++){
											control_str = control_str + control_ids[i][2] + ','
										}
									}
									$("#control_samples").val(control_str);

									job_id = $("#job_id")[0].value;
									//$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> <span style="color:black;">Filtering control samples....</span>' });
									var url = "{{ url_for('dashboard.job_control') }}"
									$.ajax({
										url: url,
										type: "POST",
										contentType: 'application/json',
										data : JSON.stringify({"job_id": job_id, "control_samples": $("#control_samples").val() }),
										dataType:'json',
										async: false
									}).done(function (data) {
										//$.unblockUI();
										if (data == false){
											$("#form").steps("previous");
										}else{
											$stopChanging = true;
										}
									}).fail(function (jqXHR, textStatus) {
										//$.unblockUI();
										$("#form").steps("previous");
									});
								}
							}


            			} else if (newIndex == 3){
            				$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });
							setTimeout($.unblockUI, 2000);
							$stopChanging = true;
							$("#saveBtn").hide();
            			}
					}


					var form = $(this);

					// Clean up if user went backward before
					if (currentIndex < newIndex){
						// To remove error styles
						$(".body:eq(" + newIndex + ") label.error", form).remove();
						$(".body:eq(" + newIndex + ") .error", form).removeClass("error");
					}

					// Disable validation on fields that are disabled or hidden.
					form.validate().settings.ignore = ":disabled,:hidden";
					// Start validation; Prevent going forward if false
					return form.valid();
				},
				onContentLoaded: function (event, currentIndex) {
					$stopChanging = false;
			   	},
				onFinishing: function (event, currentIndex){
					//Not checking any form validation directly calling onFinished event
					$('#saveInfo').modal('show');
					$('#finishInfo').val('true');
					//return true;
				},

				onFinished: function (event, currentIndex){
					//var form = $(this);
					// Submit form input
					//form.submit();
				}
			}).validate({
				errorPlacement: function (error, element){
					element.before(error);
				},
				rules: {
					confirm: {
						equalTo: "#password"
					}
				}
			});
			var case_count = 1;

		    <!-- START : Displaying the Mutation CSV data in dropdownList -->
			function loadMutationCsv(jobId) {
				var sampleApiUrl = "{{ url_for('api.sampleMutationApi') }}";
				$.ajax({
					url: sampleApiUrl,
					type: "POST",
					contentType: 'application/json',
					data : JSON.stringify({"name": "mutation" }),
					dataType:'json',
					async: false
				}).done(function (result) {
					for (var i = 0, l = result["mutation"].length; i < l; i++) {
					  data = data + '<option value="'+result["mutation"][i]+'">'+result["mutation"][i]+'</option>';
					}
				}).fail(function (jqXHR, textStatus) {
					swal("Problem while creating the file");
				});
			}
			<!-- END : Displaying the Mutation CSV data in dropdownList -->

		    <!-- START : Displaying the Gain CSV data in dropdownList -->
			function loadGainCsv(jobId) {
				var sampleApiUrl = "{{ url_for('api.sampleGainApi') }}";
				$.ajax({
					url: sampleApiUrl,
					type: "POST",
					contentType: 'application/json',
					data : JSON.stringify({"name": "gain" }),
					dataType:'json',
					async: false
				}).done(function (result) {
					for (var i = 0, l = result["gain"].length; i < l; i++) {
					  data = data + '<option value="'+result["gain"][i]+'">'+result["gain"][i]+'</option>';
					}
				}).fail(function (jqXHR, textStatus) {
					swal("Problem while creating the file");
				});
			}
			<!-- END : Displaying the Gain CSV data in dropdownList -->

		    <!-- START : Displaying the Loss CSV data in dropdownList -->
			function loadLossCsv(jobId) {
				var sampleApiUrl = "{{ url_for('api.sampleLossApi') }}";
				$.ajax({
					url: sampleApiUrl,
					type: "POST",
					contentType: 'application/json',
					data : JSON.stringify({"name": "loss" }),
					dataType:'json',
					async: false
				}).done(function (result) {
					for (var i = 0, l = result["loss"].length; i < l; i++) {
					  data = data + '<option value="'+result["loss"][i]+'">'+result["loss"][i]+'</option>';
					}
				}).fail(function (jqXHR, textStatus) {
					swal("Problem while creating the file");
				});
			}
			<!-- END : Displaying the Loss CSV data in dropdownList -->

			<!-- START : Function to load the Loader Image -->
			function loadMessage() {
				$(".sweet-alert").css("display", "none");
				$(".sweet-overlay").css("display", "none");
				$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div>' });
				setTimeout($.unblockUI, 500);
			}
			<!-- END : Function to load the Loader Image -->

			<!-- START : Function to create the Option value for the Mutation dropdown list -->
			function loadMutationData() {
				$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div>' });
				setTimeout($.unblockUI, 500);
				var caseTable = $('#caseSample').DataTable();
				var uniqueArray = [];
				var singlerow = [];
				var cells = [];

				$.each(caseTable.rows('.selected').data(), function() {
					if(this[15]!=null)
					{
						singlerow=this[15].split("|");
						for(i=0; i < singlerow.length; i++){
							if(cells.indexOf(singlerow[i]) === -1) {
								if(singlerow[i].trim()) {
									cells.push(singlerow[i]);
								}
							}
						}
					}
				});
				cells.sort();
				// Loop through array values
				for(i=0; i < cells.length; i++){
					if(uniqueArray.indexOf(cells[i]) === -1) {
						singlerow1=cells[i].split(";");
						data = data + '<option value="'+cells[i]+'">'+singlerow1[0]+'</option>';
					}
				}
			}
			<!-- END : Function to create the Option value for the Mutation dropdown list -->

			<!-- START : Function to create the Option value for the Gain dropdown list -->
			function loadGainData() {
				$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div>' });
				setTimeout($.unblockUI, 500);
				var caseTable = $('#caseSample').DataTable();
				var uniqueArray = [];
				var singlerow = [];
				var cells = [];

				$.each(caseTable.rows('.selected').data(), function() {
					if(this[16]!=null)
					{
						singlerow=this[16].split("|");
						for(i=0; i < singlerow.length; i++){
							if(cells.indexOf(singlerow[i]) === -1) {
								if(singlerow[i].trim()) {
									cells.push(singlerow[i]);
								}
							}
						}
					}
				});
				cells.sort();
				// Loop through array values
				for(i=0; i < cells.length; i++){
					if(uniqueArray.indexOf(cells[i]) === -1) {
						singlerow1=cells[i].split(";");
						data = data + '<option value="'+cells[i]+'">'+singlerow1[0]+'</option>';
					}
				}
			}
			<!-- END : Function to create the Option value for the Gain dropdown list -->

			<!-- START : Function to create the Option value for the Loss dropdown list -->
			function loadLossData() {
				$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div>' });
				setTimeout($.unblockUI, 500);
				var caseTable = $('#caseSample').DataTable();
				var uniqueArray = [];
				var singlerow = [];
				var cells = [];

				$.each(caseTable.rows('.selected').data(), function() {
					if(this[17]!=null)
					{
						singlerow=this[17].split("|");
						for(i=0; i < singlerow.length; i++){
							if(cells.indexOf(singlerow[i]) === -1) {
								if(singlerow[i].trim()) {
									cells.push(singlerow[i]);
								}
							}
						}
					}
				});
				cells.sort();
				// Loop through array values
				for(i=0; i < cells.length; i++){
					if(uniqueArray.indexOf(cells[i]) === -1) {
						singlerow1=cells[i].split(";");
						data = data + '<option value="'+cells[i]+'">'+singlerow1[0]+'</option>';
					}
				}
			}
			<!-- END : Function to create the Option value for the Loss dropdown list -->

			<!-- START : Displaying the Singature CSV on Signature Page -->
			function loadSingnatureCsv(jobId) {
				var sampleApiUrl = "{{ url_for('api.sampleCsvApi', job_id='jobId', name = 'dz_sign') }}";
				sampleApiUrl = sampleApiUrl.replace('jobId', jobId);
				$('#dg_dzSignCsv').DataTable({
					"ajax": sampleApiUrl,
					"lengthMenu": [[5, 25, 50, -1], [5, 25, 50, "All"]],
					"searching" : true,
					"order": [[ 2, "desc" ]],
				});
			}
			<!-- END : Displaying the Singature CSV on Signature Page -->

			<!-- START : Displaying the Up Singature Genes CSV on Signature Page -->
			function loadUpSignatureCsv(jobId) {
				var sampleApiUrl = "{{ url_for('api.sampleCsvApi', job_id='jobId', name = 'dz_up') }}";
				sampleApiUrl = sampleApiUrl.replace('jobId', jobId);
				$('#dg_dzUpSigGenesCsv').DataTable({
					"ajax": sampleApiUrl,
					"lengthMenu": [[5, 25, 50, -1], [5, 25, 50, "All"]],
					"searching" : true,
					 "order": [[ 4, "desc" ]],
				});
			}
			<!-- END : Displaying the Up Singature Genes CSV on Signature Page -->

			<!-- START : Displaying the Down Singature Genes CSV on Signature Page -->
			function loadDownSignatureCsv(jobId) {
				var sampleApiUrl = "{{ url_for('api.sampleCsvApi', job_id='jobId', name = 'dz_down') }}";
				sampleApiUrl = sampleApiUrl.replace('jobId', jobId);
				$('#dg_dzDownSigGenesCsv').DataTable({
					"ajax": sampleApiUrl,
					"lengthMenu": [[5, 25, 50, -1], [5, 25, 50, "All"]],
					"searching" : true,
					"order": [[ 4, "desc" ]],
				});
			}
			<!-- END : Displaying the Down Singature Genes CSV on Signature Page -->

			<!-- START : Displaying the Approved Drugs CSV -->
			function loadApprovedDrugsCsv(jobId) {
				var sampleApiUrl = "{{ url_for('api.sampleCsvApi', job_id='jobId', name = 'approved_drugs') }}";
				sampleApiUrl = sampleApiUrl.replace('jobId', jobId);
				$('#dg_dzApprovedDrugsCsv').DataTable({
					"ajax": sampleApiUrl,
					"lengthMenu": [[5, 25, 50, -1], [5, 25, 50, "All"]],
					"searching" : true,
				});
			}
			<!-- END : Displaying the Approved Drugs CSV -->

			function caseForm(){

				/* START : Code for the Radio Button on Case Page */

				$("#manual_case").click(function(){
					$("#auto_search").css('display','none');
					$("#manual_search_case").css('display','block');


				});

				$("#auto_case").click(function(){
					$("#auto_search").css('display','block');
					$("#manual_search_case").css('display','none');

					<!--if( $.fn.dataTable.isDataTable("#caseSample") ) {-->
						<!--var caseTable = $('#caseSample').DataTable();-->
						<!--strSampleCaseIdList = '';-->
						<!--caseTable.columns(2).search("^" + strSampleCaseIdList + "$", true, false, true).draw();-->
					<!--} else {-->
						<!--alert("ELSE");-->
					<!--}-->
				});

				/* END : Code for the Radio Button on Case Page */


				$(document).on('click','.casePlusAddFilter',function(){
				    if($("#ourCustomSelect").val() == "" || $("#ourCustomSelect").val() == null){
						swal("Please select disease name")
					} else {
						$('#hidden-data').val("0");
						$.blockUI({ message: '<div class="full-width"Please click Compute Control Samples before proceeding><img src="/static/img/ajax-loader.gif" /></div> ' });
						if ($('#caseAddFilter').is(':empty')){
							var row_id = 0;
						}
						else{
							var row_id = this.id.split('_')[2];
						}
						this.disabled = true
						row_id = parseInt(row_id) + 1;

						var data = '<div id="crow_'+row_id+'" class="row m-n"><div class="form-group">'+
							'<div class="col-lg-4 ui-widget" style="padding-left:5px;">'+
								'<a href="#" id="caseplus_row_'+row_id+'" class="casePlusAddFilter m-l-xs m-r-xs m-t-xs" style="margin-top:5px !important;">'+
									'<i class="fa fa-plus-square" aria-hidden="true"></i>'+
								'</a>'+
								'<a href="#" id="caseminus_row_'+row_id+'" class="caseMinusRemoveFilter m-l-xs m-r-xs m-t-xs" style="margin-top:5px !important;">'+
									'<i class="fa fa-minus-square" aria-hidden="true"></i>'+
								'</a>'+
								'<select id="case_select_'+row_id+'" class="search-box pull-right" name="feature" style="height:28px;float:left;">' +
									'<option>Select feature</option>';
							{% for k, v in features.iteritems() %}
								var str = "{{ v }}"
								if(str == 'Tissue Type')
									{
									if(features_data.tissue_types.length > 0)
										data = data+'<option value="'+str+'">'+str+'</option>';
									else
										data = data+'<option value="'+str+'" disabled>'+str+'</option>';
									}

								if(str == 'Site' )
									{
									if(features_data.sites.length > 0)
										data = data+'<option value="'+str+'">'+str+'</option>';
									else
										data = data+'<option value="'+str+'" disabled>'+str+'</option>';
									}

								if(str == 'Gender' )
									{
									if(features_data.gender.length > 0)
										data = data+'<option value="'+str+'">'+str+'</option>';
									else
										data = data+'<option value="'+str+'" disabled>'+str+'</option>';
									}
								
							<!--	if(str == 'Metastatic Site' )-->
							<!-- 		{ -->
							<!-- 		if(features_data.metastatics.length > 0) -->
							<!-- 			data = data+'<option value="'+str+'">'+str+'</option>'; -->
							<!-- 		else -->
							<!-- 			data = data+'<option value="'+str+'" disabled>'+str+'</option>';-->
							<!-- 		} -->
								

								<!--if(str == 'EGFR' )-->
									<!--{-->
									<!--if(features_data.egfr.length > 0)-->
										<!--data = data+'<option value="'+str+'">'+str+'</option>';-->
									<!--else-->
										<!--data = data+'<option value="'+str+'" disabled>'+str+'</option>';-->
									<!--}-->

								<!--if(str == 'IDH1')-->
									<!--{-->
									<!--if(features_data.idh1.length > 0)-->
										<!--data = data+'<option value="'+str+'">'+str+'</option>';-->
									<!--else-->
										<!--data = data+'<option value="'+str+'" disabled>'+str+'</option>';-->
									<!--}-->

								<!--if(str == 'IDH2')-->
									<!--{-->
									<!--if(features_data.idh2.length > 0)-->
										<!--data = data+'<option value="'+str+'">'+str+'</option>';-->
									<!--else-->
										<!--data = data+'<option value="'+str+'" disabled>'+str+'</option>';-->
									<!--}-->

								<!--if(str == 'TP53' )-->
									<!--{-->
									<!--if(features_data.tp53.length > 0)-->
										<!--data = data+'<option value="'+str+'">'+str+'</option>';-->
									<!--else-->
										<!--data = data+'<option value="'+str+'" disabled>'+str+'</option>';-->
									<!--}-->

								if(str == 'Age')
									data = data+'<option value="'+str+'">'+str+'</option>';
									<!--if(features_data.age_in_year.length > 0)-->
										<!--data = data+'<option value="'+str+'>'+str+'</option>';-->
									<!--else-->
										<!--data = data+'<option value="'+str+'" disabled>'+str+'</option>';-->
								
								if(str == 'Tumor Grade')
									{
									if(features_data.grades.length > 0)
										data = data+'<option value="'+str+'">'+str+'</option>';
									else
										data = data+'<option value="'+str+'" disabled>'+str+'</option>';
									}
     								
								if(str == 'Tumor Stage' )
									{
									if(features_data.stages.length > 0)
										data = data+'<option value="'+str+'">'+str+'</option>';
									else
										data = data+'<option value="'+str+'" disabled>'+str+'</option>';
									}

								if(str == 'Mutation' )
								{
									if(features_data.mutation_list.length > 0)
										data = data+'<option value="'+str+'"title="It may take a while to load mutations data!">'+str+'</option>';
										<!--data = data+'<option value="'+str+'" >'+str+'</option>';-->

									else
										data = data+'<option value="'+str+'" disabled>'+str+'</option>';
								}

								if(str == 'Gain' )
								{
									if(features_data.gain_list.length > 0)
										data = data+'<option value="'+str+'"title="It may take a while to load copy number gain data!">'+str+'</option>';
										<!--data = data+'<option value="'+str+'" >'+str+'</option>';-->

									else
										data = data+'<option value="'+str+'" disabled>'+str+'</option>';
								}

								if(str == 'Loss' )
								{
									if(features_data.loss_list.length > 0)
										data = data+'<option value="'+str+'"title="It may take a while to load copy number loss data!">'+str+'</option>';
										<!--data = data+'<option value="'+str+'" >'+str+'</option>';-->

									else
										data = data+'<option value="'+str+'" disabled>'+str+'</option>';
								}
							{% endfor %}

							data = data +'</select>'+
								'</div>'+
								'<div id="casecolsm_'+row_id+'" class="col-lg-8" style="padding-right:0;"></div>'+
							'</div>';
							$("#caseAddFilter").append(data);
						$('.search-box').SumoSelect({search: true, searchText:'Enter here.' });
					}
					$.unblockUI();
				});

				$(document).on('click','.caseMinusRemoveFilter',function(){

					row_id = this.id.split('_')[2];
					myval = $('div#crow_'+row_id+'.row input.casefilter').attr('data-column-index');

					div_obj = $(this).parents('div#crow_'+row_id+'.row')
					if (div_obj.length>0){
						div_obj.remove();

						if (row_id == 1){
							prev_obj = $(".diseaseNameSelect").children(".casePlusAddFilter");
						}
						else{
							prev_obj = $("div#crow_"+(row_id-1)+".row .casePlusAddFilter");
						}
						prev_obj[0].disabled = false;

					}
					my_caseFilter(myval);
				});

				function my_caseFilter(myval) {

					disease_name = $("#getDiseaseName").val();
					var caseTable = $('#caseSample').DataTable();
					caseTable.rows('.selected').deselect();
					caseTable.draw();

					if( myval == 2 ) {
						caseTable.columns(3).search('');
					} else if( myval == 5 ) {
						caseTable.columns(6).search('');
					} else if( myval == 6 ) {
						caseTable.columns(7).search('');
					} else if( myval == 7 ) {
						caseTable.columns(8).search('');
					} else if( myval == 8 ) {
						caseTable.columns(9).search('');
					} else if( myval == 9 ) {
						caseTable.columns(10).search('');
					} else if( myval == 10 ) {
						caseTable.columns(11).search('');
					} else if( myval == 11 ) {
						caseTable.columns(12).search('');
					} else if( myval == 12 ) {
						caseTable.columns(13).search('');
					} else if( myval == 13 ) {
						caseTable.columns(14).search('');
					} else if( myval == 15 ) {
						caseTable.columns(15).search('');
					} else if( myval == 16 ) {
						caseTable.columns(16).search('');
					} else if( myval == 17 ) {
						caseTable.columns(17).search('');
					}

					<!--caseTable.columns(8).search(disease_name, true, false ).draw();-->
					//alert(disease_name);
					caseTable.columns(8).search("^" + disease_name + "$", true, false, true).draw();

					var rows = $("#caseSample").dataTable().$('tr', {"filter":"applied"});
					caseTable.rows(rows).select();

					var res = $(".select-item").text().split(" ");
					if( parseInt(res[0]) >= 10 ) {
						$("#pageCount").remove();
					}
				}

				$(document).on('change', '.search-box', function(){
					feature_val = this.value;
					//alert(feature_val);
					<!--$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div>' });-->
					<!--setTimeout($.unblockUI, 500);-->
					if(feature_val == 'Select feature'){}
					else
					{
						render(this.id,feature_val);
					}
				});

				function render(idd,feature_val){
					row_id=idd.split('_')[2];


					$("#casecolsm_" + row_id).html("");
					data = '';
					if (feature_val == "Tissue Type" || feature_val == 1){
						<!--for(var i=0;i<case_tissue_types.length;i++){-->
							<!--data = data+'<div class="i-checks pull-left">'+-->
								<!--'<label class="m-r-sm">'+-->
									<!--'<input type="checkbox" checked name="case_type" group="caseType" value="'+ case_tissue_types[i] +'"class="casefilter" data-column-index="2">'+-->
									<!--'<i></i>'+ case_tissue_types[i] +-->
								<!--'</label>'+-->
							<!--'</div>';-->
						<!--}-->

						<!-- START : Code for Tissue Type -->
						data = '<input type="text" name="case_tissue_type_hd" style="display:none;" class="casefilter" data-column-index="2"><select class="casefilter dg_caseTissueTypeFilter search-box" multiple="multiple" placeholder="Select Tissue Type" name="case_tissue_type" data-column-index="2">';

						for(var i=0;i<case_tissue_types.length;i++){
							data = data + '<option value="'+case_tissue_types[i]+'">'+case_tissue_types[i]+'</option>';
						}
						data = data + '</select>';
						<!-- END : Code for Tissue Type -->

					}else if (feature_val == "Site" || feature_val == 2){

						<!-- START : Code for Site Feature -->
						data = '<input type="text" name="case_site_hd" style="display:none;" class="casefilter" data-column-index="4"><select class="casefilter dg_caseSiteFilter search-box" multiple="multiple" placeholder="Select Site" name="case_site" data-column-index="4">';
						<!-- END : Code for Site Feature -->

						<!--'<option>Select Site</option>'; // select2_demo_3-->
							   {% for s in sites %}
							   		var str = '{{s}}'
							   		var index = case_sites.indexOf(str);
							   		if(index != -1) {
							   			data = data + '<option value="{{ s }}">{{s}}</option>';
							   		}
							   		<!--else-->
							   			<!--data = data + '<option value="{{ s }}" disabled>{{s}}</option>';-->
								{% endfor %}
							  data = data + '</select>';

					}else if (feature_val == "Gender" || feature_val == 3){

						<!--for(var i=0;i<case_gender.length;i++)-->
						<!--{-->

							<!--data = data + '<div class="i-checks pull-left m-r-sm">'+-->
								<!--'<span>'+-->
									<!--'<input type="radio" group="case_gender" name="case_gender" value="'+case_gender[i]+'"  style="display:inline;margin-right:7px;" class="casefilter" data-column-index="5">'+-->
									<!--case_gender[i]+-->
								<!--'</span>'+-->
							<!--'</div>';-->
						<!--}-->

						<!-- START : Code for Gender Feature -->
						data = '<input type="text" name="case_gender_hd" style="display:none;" class="casefilter" data-column-index="5"><select class="casefilter dg_caseGenderFilter search-box" multiple="multiple" placeholder="Select Gender" name="case_gender" data-column-index="5">';
							for(var i=0;i<case_gender.length;i++){
								data = data + '<option value="'+case_gender[i]+'">'+case_gender[i]+'</option>';
							}
						  data = data + '</select>';
						<!-- END : Code for  Gender Feature -->

					}else if (feature_val == "Metastatic Site" || feature_val == 4){
						data = '<input type="text" name="case_metastatic_hd" style="display:none;" class="casefilter" data-column-index="6"><select class="casefilter dg_caseMetastaticFilter search-box" multiple="multiple" placeholder="Select Metastatics" name="case_metastatic" data-column-index="6">';
						<!--'<option>Select Metastatics</option>'// select2_demo_3-->
  								{% for m in metastatics %}
							   		var str = '{{m}}'
							   		var index = case_metastatics.indexOf(str);
							   		if(index != -1) {
							   			data = data + '<option value="{{ m }}">{{m}}</option>';
							   		}
							   		<!--else-->
							   			<!--data = data + '<option value="{{ m }}" disabled>{{m}}</option>';-->
								{% endfor %}
							  data = data + '</select>';

					}else if (feature_val == "EGFR" || feature_val == 5){
						for(var i=0;i<case_egfr.length;i++)
						{

							data = data+'<div class="i-checks pull-left">'+
								'<label class="m-r-sm">'+
									'<input type="checkbox" checked name="case_EGFR" group="caseEGFR" value="'+case_egfr[i]+'"  class="casefilter" data-column-index="8">'+
									'<i></i> '+case_egfr[i]+
								'</label>'+
							'</div>';

						}

					}else if (feature_val == "IDH1" || feature_val == 6){

						for(var i=0;i<case_idh1.length;i++){

							data = data+'<div class="i-checks pull-left">'+
								'<label class="m-r-sm">'+
									'<input type="checkbox" checked name="case_IDH1" group="caseIDH1" value="'+case_idh1[i]+'"  class="casefilter" checked="" data-column-index="9">'+
									'<i></i> '+ case_idh1[i]+
								'</label>'+
							'</div>';
						}

					}else if (feature_val == "IDH2" || feature_val == 7){
						for(var i=0;i<case_idh2.length;i++){
							data = data+'<div class="i-checks pull-left">'+
								'<label class="m-r-sm">'+
									'<input type="checkbox" checked name="case_IDH2" group="caseIDH2" value="'+case_idh2[i]+'"  class="casefilter"  data-column-index="10">'+
									'<i></i> '+case_idh2[i]+
								'</label>'+
							'</div>';
						}

					}else if (feature_val == "TP53" || feature_val == 8){
						for(var i=0;i<case_tp53.length;i++){
							data = data+'<div class="i-checks pull-left">'+
								'<label class="m-r-sm">'+
									'<input type="checkbox" checked name="case_TP53" group="caseTP53" value="'+case_tp53[i]+'" class="casefilter"   data-column-index="11">'+
									'<i></i> '+case_tp53[i]+
								'</label>'+
							'</div>';
						}
					}else if (feature_val == "Age" || feature_val == 9){
						data = 	'<input type="text" id="caseAgeDisplay" name="case_age" data-column-index="14" class="casefilter ageDisplayInput m-t-xs" readonly>'+
								'<div id="caseAgeSlider" class="ageSliderDiv m-t-sm" data-column-index="14"></div>'
						// age slider code --------------
						$( function() {
							{% if not job or not job.jobs.0.case_age_in_year %}
								$( "#caseAgeSlider" ).slider({
									range: true,
									min: 1,
									max: 100,
									values: [ 40, 60 ],
									slide: function( event, ui ) {
										$("#caseAgeDisplay").val(
											ui.values[ 0 ] + " - " +
											ui.values[ 1 ]
										);
									},
									change: function( event, ui ) {
										 //caseFilter();
									},
									stop: function( event, ui ) {
										caseFilterTest();
										var caseTable = $('#caseSample').DataTable();
										caseTable.rows('.selected').deselect();
									  	caseTable.draw();
									  	var rows = $("#caseSample").dataTable().$('tr', {"filter":"applied"});
										caseTable.rows(rows).select();

										dgGetPageCount();
									}
								});

								$("#caseAgeDisplay").val(
									$("#caseAgeSlider").slider("values",0) + " - " +
									$("#caseAgeSlider").slider("values",1)
								);
							{% endif %}
						});
					// age slider code --------------

					}else if (feature_val == "Tumor Grade" || feature_val == 10){
						data = '<input type="text" name="case_tumor_grade_hd" style="display:none;" class="casefilter" data-column-index="12"><input id="getCaseTumorGradeName" name="case_tumor_grade_name" class="form-control" style="display:none;" value="" type="text"><select class="casefilter dg_caseTumorGradeFilter search-box" multiple="multiple" placeholder="Select Grade" name="case_tumor_grade" data-column-index="12">';
							<!--'<option>Select Grade</option>';-->
						   	{% for g in grades %}
								var str = '{{g}}'
								var index = case_grades.indexOf(str);
								if(index != -1)
									data = data + '<option value="{{ g }}">{{g}}</option>';
								<!--else-->
									<!--data = data + '<option value="{{ g }}" disabled>{{g}}</option>';-->
							{% endfor %}
						data = data + '</select>';

					}else if (feature_val == "Tumor Stage" || feature_val == 11){
						<!-- START : Code for Tumor Stage Feature -->
						data = '<input type="text" name="case_tumor_stage_hd" style="display:none;" class="casefilter" data-column-index="13"><input id="getCaseTumorStageName" name="case_tumor_stage_name" class="form-control" style="display:none;" value="" type="text"><select class="casefilter dg_caseTumorStageFilter search-box" multiple="multiple" placeholder="Select Stage" name= "case_tumor_stage" tabindex="4" data-column-index="13">';
						<!-- END : Code for Tumor Stage Feature -->
							{% for st in stages %}
								var str = '{{st}}'
								var index = case_stages.indexOf(str);
								if(index != -1) {
									data = data + '<option value="{{ st }}">{{st}}</option>';
								}
								<!--else-->
									<!--data = data + '<option value="{{ st }}" disabled>{{st}}</option>';-->
							{% endfor %}
						data = data + '</select>';
					}else if (feature_val == "Mutation" || feature_val == 12){

						<!--&lt;!&ndash; START : Code for Mutation Feature &ndash;&gt;-->
						<!--data = '<input type="text" name="case_mutation_hd" style="display:none;" class="casefilter" data-column-index="15"><input id="getCaseMutationName" name="case_mutation_name1" class="form-control" style="display:none;" value="" type="text" data-column-index="15">';-->
						<!--&lt;!&ndash; END : Code for Mutation Feature &ndash;&gt;-->
						<!--data = data + '<select class="casefilter dg_caseMutationFilter search-box"  multiple="multiple" placeholder="Select Mutation" name= "case_mutation_name" tabindex="4" data-column-index="15">';-->
						<!--testDemo();-->
						<!--data = data + '</select>';-->

						<!-- START : DG Change Here -->
							var caseTable = $('#caseSample').DataTable();
							var singlerow = [];
							var cells = [];

							$.each(caseTable.rows('.selected').data(), function() {
								if(this[15]!=null)
								{
									singlerow=this[15].split("|");
									for(i=0; i < singlerow.length; i++){
										if(cells.indexOf(singlerow[i]) === -1) {
											if(singlerow[i].trim()) {
												cells.push(singlerow[i]);
											}
										}
									}
								}
							});

							if( cells.length <= 5000 ) {
								<!-- START : Code for Mutation Feature -->
								data = '<input type="text" name="case_mutation_hd" style="display:none;" class="casefilter" data-column-index="15"><input id="getCaseMutationName" name="case_mutation_name1" class="form-control" style="display:none;" value="" type="text" data-column-index="15">';
								<!-- END : Code for Mutation Feature -->
								data = data + '<select class="casefilter dg_caseMutationFilter search-box"  multiple="multiple" placeholder="Select Mutation" name= "case_mutation_name" tabindex="4" data-column-index="15">';
								loadMutationData();
								data = data + '</select>';
							} else {
								swal({
									title: "",
									text: "It may take a while to load large mutations data!",
									type: "warning",
									showCancelButton: false,
									confirmButtonColor: '#DD6B55',
									confirmButtonText: 'Click here to continue!',
									closeOnConfirm: false
								}, function(isConfirm) {
									if( isConfirm )  {

										setInterval(loadMessage(), 500);

										<!-- START : Code for Mutation Feature -->
										data = '<input type="text" name="case_mutation_hd" style="display:none;" class="casefilter" data-column-index="15"><input id="getCaseMutationName" name="case_mutation_name1" class="form-control" style="display:none;" value="" type="text" data-column-index="15">';
										<!-- END : Code for Mutation Feature -->
										data = data + '<select class="casefilter dg_caseMutationFilter search-box"  multiple="multiple" placeholder="Select Mutation" name= "case_mutation_name" tabindex="4" data-column-index="15">';

										var uniqueArray = [];
										var dg_singlerow = [];
										var cells1 = [];
										var singlerow1 = [];

										$.each(caseTable.rows('.selected').data(), function() {
											if(this[15]!=null)
											{
												dg_singlerow=this[15].split("|");
												for(i=0; i < dg_singlerow.length; i++){
													if(cells1.indexOf(dg_singlerow[i]) === -1) {
														if(dg_singlerow[i].trim()) {
															cells1.push(dg_singlerow[i]);
														}
													}
												}
											}
										});

										for(i=0; i < cells1.length; i++){
											if(uniqueArray.indexOf(cells1[i]) === -1) {
												<!--uniqueArray.push(cells1[i]);-->
												singlerow1=cells1[i].split(";");
												<!--console.log(singlerow1[0]);-->
												data = data + '<option value="'+cells1[i]+'">'+singlerow1[0]+'</option>';
											}
										}
									}
									data = data + '</select>';
									$("#casecolsm_" + row_id).append(data);
									$(".search-box").SumoSelect({search: true, searchText: 'Enter here.'});
									$("input[type='radio']").checkboxradio();
									$("fieldset[type='radio']").controlgroup();
								});
							}
							<!-- END : DG Change Here -->

					}else if (feature_val == "Gain" || feature_val == 13){

						<!--&lt;!&ndash; START : Code for Gain Feature &ndash;&gt;-->
						<!--data = '<input type="text" name="case_gain_hd" style="display:none;" class="casefilter" data-column-index="16"><input id="getCaseGainName" name="case_gain_name1" class="form-control" style="display:none;" value="" type="text" data-column-index="16">';-->
						<!--&lt;!&ndash; END : Code for Gain Feature &ndash;&gt;-->
						<!--data = data + '<select class="casefilter dg_caseGainFilter search-box"  multiple="multiple" placeholder="Select Gain" name= "case_gain_name" tabindex="4" data-column-index="16">';-->
						<!--testDemo();-->
						<!--data = data + '</select>';-->

						<!-- START : DG Change Here -->
							var caseTable = $('#caseSample').DataTable();
							var singlerow = [];
							var cells = [];

							$.each(caseTable.rows('.selected').data(), function() {
								if(this[16]!=null)
								{
									singlerow=this[16].split("|");
									for(i=0; i < singlerow.length; i++){
										if(cells.indexOf(singlerow[i]) === -1) {
											if(singlerow[i].trim()) {
												cells.push(singlerow[i]);
											}
										}
									}
								}
							});

							if( cells.length <= 5000 ) {
								<!-- START : Code for Gain Feature -->
								data = '<input type="text" name="case_gain_hd" style="display:none;" class="casefilter" data-column-index="16"><input id="getCaseGainName" name="case_gain_name1" class="form-control" style="display:none;" value="" type="text" data-column-index="16">';
								<!-- END : Code for Gain Feature -->
								data = data + '<select class="casefilter dg_caseGainFilter search-box"  multiple="multiple" placeholder="Select Gain" name= "case_gain_name" tabindex="4" data-column-index="16">';
								loadGainData();
								data = data + '</select>';
							} else {
								swal({
									title: "",
									text: "It may take a while to load large copy number gain data!",
									type: "warning",
									showCancelButton: false,
									confirmButtonColor: '#DD6B55',
									confirmButtonText: 'Click here to continue!',
									closeOnConfirm: false
								}, function(isConfirm) {
									if( isConfirm )  {

										setInterval(loadMessage(), 500);

										<!-- START : Code for Gain Feature -->
										data = '<input type="text" name="case_gain_hd" style="display:none;" class="casefilter" data-column-index="16"><input id="getCaseGainName" name="case_gain_name1" class="form-control" style="display:none;" value="" type="text" data-column-index="16">';
										<!-- END : Code for Gain Feature -->
										data = data + '<select class="casefilter dg_caseGainFilter search-box"  multiple="multiple" placeholder="Select Gain" name= "case_gain_name" tabindex="4" data-column-index="16">';

										var uniqueArray = [];
										var dg_singlerow = [];
										var cells1 = [];
										var singlerow1 = [];

										$.each(caseTable.rows('.selected').data(), function() {
											if(this[16]!=null)
											{
												dg_singlerow=this[16].split("|");
												for(i=0; i < dg_singlerow.length; i++){
													if(cells1.indexOf(dg_singlerow[i]) === -1) {
														if(dg_singlerow[i].trim()) {
															cells1.push(dg_singlerow[i]);
														}
													}
												}
											}
										});

										for(i=0; i < cells1.length; i++){
											if(uniqueArray.indexOf(cells1[i]) === -1) {
												<!--uniqueArray.push(cells1[i]);-->
												singlerow1=cells1[i].split(";");
												<!--console.log(singlerow1[0]);-->
												data = data + '<option value="'+cells1[i]+'">'+singlerow1[0]+'</option>';
											}
										}
									}
									data = data + '</select>';
									$("#casecolsm_" + row_id).append(data);
									$(".search-box").SumoSelect({search: true, searchText: 'Enter here.'});
									$("input[type='radio']").checkboxradio();
									$("fieldset[type='radio']").controlgroup();
								});
							}
							<!-- END : DG Change Here -->

					}else if (feature_val == "Loss" || feature_val == 14){

						<!--&lt;!&ndash; START : Code for Loss Feature &ndash;&gt;-->
						<!--data = '<input type="text" name="case_loss_hd" style="display:none;" class="casefilter" data-column-index="17"><input id="getCaseLossName" name="case_loss_name1" class="form-control" style="display:none;" value="" type="text" data-column-index="17">';-->
						<!--&lt;!&ndash; END : Code for Loss Feature &ndash;&gt;-->
						<!--data = data + '<select class="casefilter dg_caseLossFilter search-box"  multiple="multiple" placeholder="Select Loss" name= "case_loss_name" tabindex="4" data-column-index="17">';-->
						<!--testDemo();-->
						<!--data = data + '</select>';-->

						<!-- START : DG Change Here -->
							var caseTable = $('#caseSample').DataTable();
							var singlerow = [];
							var cells = [];

							$.each(caseTable.rows('.selected').data(), function() {
								if(this[17]!=null)
								{
									singlerow=this[17].split("|");
									for(i=0; i < singlerow.length; i++){
										if(cells.indexOf(singlerow[i]) === -1) {
											if(singlerow[i].trim()) {
												cells.push(singlerow[i]);
											}
										}
									}
								}
							});

							if( cells.length <= 5000 ) {
								<!-- START : Code for Loss Feature -->
								data = '<input type="text" name="case_loss_hd" style="display:none;" class="casefilter" data-column-index="17"><input id="getCaseLossName" name="case_loss_name1" class="form-control" style="display:none;" value="" type="text" data-column-index="17">';
								<!-- END : Code for Loss Feature -->
								data = data + '<select class="casefilter dg_caseLossFilter search-box"  multiple="multiple" placeholder="Select Loss" name= "case_loss_name" tabindex="4" data-column-index="17">';
								loadLossData();
								data = data + '</select>';
							} else {
								swal({
									title: "",
									text: "It may take a while to load large copy number loss data!",
									type: "warning",
									showCancelButton: false,
									confirmButtonColor: '#DD6B55',
									confirmButtonText: 'Click here to continue!',
									closeOnConfirm: false
								}, function(isConfirm) {
									if( isConfirm )  {

										setInterval(loadMessage(), 500);

										<!-- START : Code for Loss Feature -->
										data = '<input type="text" name="case_loss_hd" style="display:none;" class="casefilter" data-column-index="17"><input id="getCaseLossName" name="case_loss_name1" class="form-control" style="display:none;" value="" type="text" data-column-index="17">';
										<!-- END : Code for Loss Feature -->
										data = data + '<select class="casefilter dg_caseLossFilter search-box"  multiple="multiple" placeholder="Select Loss" name= "case_loss_name" tabindex="4" data-column-index="17">';

										var uniqueArray = [];
										var dg_singlerow = [];
										var cells1 = [];
										var singlerow1 = [];

										$.each(caseTable.rows('.selected').data(), function() {
											if(this[17]!=null)
											{
												dg_singlerow=this[17].split("|");
												for(i=0; i < dg_singlerow.length; i++){
													if(cells1.indexOf(dg_singlerow[i]) === -1) {
														if(dg_singlerow[i].trim()) {
															cells1.push(dg_singlerow[i]);
														}
													}
												}
											}
										});

										for(i=0; i < cells1.length; i++){
											if(uniqueArray.indexOf(cells1[i]) === -1) {
												<!--uniqueArray.push(cells1[i]);-->
												singlerow1=cells1[i].split(";");
												<!--console.log(singlerow1[0]);-->
												data = data + '<option value="'+cells1[i]+'">'+singlerow1[0]+'</option>';
											}
										}
									}
									data = data + '</select>';
									$("#casecolsm_" + row_id).append(data);
									$(".search-box").SumoSelect({search: true, searchText: 'Enter here.'});
									$("input[type='radio']").checkboxradio();
									$("fieldset[type='radio']").controlgroup();
								});
							}
							<!-- END : DG Change Here -->

					}

					$("#casecolsm_" + row_id).append(data);
				   	$(".search-box").SumoSelect({search: true, searchText: 'Enter here.'});
				   	//$(".dg_caseTissueTypeFilter").SumoSelect({search: true, searchText: 'Enter here.'});

				   	if (feature_val == "Tissue Type"){
				   		$('select.search-box.dg_caseTissueTypeFilter')[0].sumo.selectAll();
				   	} else if (feature_val == "Site"){
				   		$('select.search-box.dg_caseSiteFilter')[0].sumo.selectAll();
				   	} else if (feature_val == "Gender"){
				   		$('select.search-box.dg_caseGenderFilter')[0].sumo.selectAll();
				   	} else if (feature_val == "Metastatic Site"){
				   		$('select.search-box.dg_caseMetastaticFilter')[0].sumo.selectAll();
				   	} else if (feature_val == "Tumor Grade"){
				   		$('select.search-box.dg_caseTumorGradeFilter')[0].sumo.selectAll();
				   	} else if (feature_val == "Tumor Stage"){
				   		$('select.search-box.dg_caseTumorStageFilter')[0].sumo.selectAll();
				   	}



				   	<!--$('select.dg_caseGenderFilter')[0].sumo.selectAll();-->
				   	<!--$('select.dg_caseMetastaticFilter')[0].sumo.selectAll();-->
				   	<!--$('select.dg_caseTumorGradeFilter')[0].sumo.selectAll();-->
				   	<!--$('select.dg_caseTumorStageFilter')[0].sumo.selectAll();-->

				   	//alert($("#casecolsm_" + row_id).child().child().child().html());


				   	$("input[type='radio']").checkboxradio();
					$("fieldset[type='radio']").controlgroup();
				}

	            };//FINISH CASE JS===================================================================================================

				<!-- START : Feature filter for the Age  -->
				function caseFilterTest() {
					$.fn.dataTable.ext.search.push(
						function( settings, data, dataIndex ) {
							var min = parseFloat($( "#caseAgeSlider" ).slider( "values", 0 ));
							var max = parseFloat($( "#caseAgeSlider" ).slider( "values", 1 ));
							var col = parseFloat( data[4] ) || 0; // data[number] = column number;

								if ( ( isNaN( min ) && isNaN( max ) ) ||
									 ( isNaN( min ) && col <= max ) ||
									 ( min <= col   && isNaN( max ) ) ||
									 ( min <= col   && col <= max ) )
								{
								  return true;
								}
								return false;
						}
					);
				}
				<!-- END : Feature filter for the Age  -->


			//CONTROL JS===================================================================================================

			function controlForm(){

				$(document).on('click','.controlPlusAddFilter',function(){
					$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });
					if ($('#controlAddFilter').is(':empty')){
						var row_id = 0;
					}
					else{
						var row_id = this.id.split('_')[2];
					}
					this.disabled = true
					row_id = parseInt(row_id) + 1;

					var data = '<div id="cnrow_'+row_id+'" class="row m-n"><div class="form-group">'+
						'<div class="col-lg-4 ui-widget innerControlSel" style="padding-left:5px;">';

						data = data + '<a href="#" id="controlplus_row_'+row_id+'" class="controlPlusAddFilter m-l-xs m-r-xs m-t-xs" style="margin-top:5px !important;">'+
							'<i class="fa fa-plus-square" aria-hidden="true"></i>'+
						'</a>'+
						'<a href="#" id="controlminus_row_'+row_id+'" class="controlMinusRemoveFilter m-l-xs m-r-xs m-t-xs" style="margin-top:5px !important;">'+
							'<i class="fa fa-minus-square" aria-hidden="true"></i>'+
						'</a>';
						data = data + '<select id="control_select_'+row_id+'" class="controlfeature search-boxControl pull-right" name="cfeature" style="height:28px;float:left;">' +
							'<option>Select feature</option>';
					{% for k, v in features.iteritems() %}
						var str = "{{ v }}"
						if(str == 'Tissue Type')
							{
							if(control_features_data.tissue_types.length > 0)
								data = data+'<option value="'+str+'">'+str+'</option>';
							else
								data = data+'<option value="'+str+'" disabled>'+str+'</option>';
							}

						if(str == 'Site' )
							{
							if(control_features_data.sites.length > 0)
								data = data+'<option value="'+str+'">'+str+'</option>';
							else
								data = data+'<option value="'+str+'" disabled>'+str+'</option>';
							}

						if(str == 'Gender' )
							{
							if(control_features_data.gender.length > 0)
								data = data+'<option value="'+str+'">'+str+'</option>';
							else
								data = data+'<option value="'+str+'" disabled>'+str+'</option>';
							}

						if(str == 'Metastatic Site' )
							{
							if(control_features_data.metastatics.length > 0)
								data = data+'<option value="'+str+'">'+str+'</option>';
							else
								data = data+'<option value="'+str+'" disabled>'+str+'</option>';
							}

						if(str == 'EGFR' )
							{
							if(control_features_data.egfr.length > 0)
								data = data+'<option value="'+str+'">'+str+'</option>';
							else
								data = data+'<option value="'+str+'" disabled>'+str+'</option>';
							}

						if(str == 'IDH1')
							{
							if(control_features_data.idh1.length > 0)
								data = data+'<option value="'+str+'">'+str+'</option>';
							else
								data = data+'<option value="'+str+'" disabled>'+str+'</option>';
							}

						if(str == 'IDH2')
							{
							if(control_features_data.idh2.length > 0)
								data = data+'<option value="'+str+'">'+str+'</option>';
							else
								data = data+'<option value="'+str+'" disabled>'+str+'</option>';
							}

						if(str == 'TP53' )
							{
							if(control_features_data.tp53.length > 0)
								data = data+'<option value="'+str+'">'+str+'</option>';
							else
								data = data+'<option value="'+str+'" disabled>'+str+'</option>';
							}

						if(str == 'Age')
							data = data+'<option value="'+str+'">'+str+'</option>';

						if(str == 'Tumor Grade')
							{
							if(control_features_data.grades.length > 0)
								data = data+'<option value="'+str+'">'+str+'</option>';
							else
								data = data+'<option value="'+str+'" disabled>'+str+'</option>';
							}

						if(str == 'Tumor Stage' )
							{
							if(control_features_data.stages.length > 0)
								data = data+'<option value="'+str+'">'+str+'</option>';
							else
								data = data+'<option value="'+str+'" disabled>'+str+'</option>';
							}
					{% endfor %}

					data = data +'</select>'+
						'</div>'+
						'<div id="controlcolsm_'+row_id+'" class="col-lg-8" style="padding-right:0;"></div>'+
					'</div>';
					$("#controlAddFilter").append(data);
					$('.search-boxControl').SumoSelect({search: true, searchText:'Enter here.' });

					$.unblockUI();

				});


				$(document).on('click','.controlMinusRemoveFilter',function(){
					row_id = this.id.split('_')[2];

					myval = $('div#cnrow_'+row_id+'.row input.controlfilter').attr('data-column-index');

					div_obj = $(this).parents('div#cnrow_'+row_id+'.row')
					if (div_obj.length>0){
						div_obj.remove();
						prev_obj = $("div#cnrow_"+(row_id-1)+".row .controlPlusAddFilter");
						prev_obj[0].disabled = false;
					}
					//controlFilter()
					my_controlFilter(myval);
				});

				function my_controlFilter(myval) {
					//disease_name = $("#getDiseaseName").val();
					var controlTable = $('#controlSample').DataTable();
					controlTable.rows('.selected').deselect();
					controlTable.draw();

					if( myval == 2 ) {
						controlTable.columns(3).search('').draw();
					} else if( myval == 5 ) {
						controlTable.columns(6).search('').draw();
					} else if( myval == 6 ) {
						controlTable.columns(7).search('').draw();
					} else if( myval == 7 ) {
						controlTable.columns(8).search('').draw();
					} else if( myval == 8 ) {
						controlTable.columns(9).search('').draw();
					} else if( myval == 9 ) {
						controlTable.columns(10).search('').draw();
					} else if( myval == 10 ) {
						controlTable.columns(11).search('').draw();
					} else if( myval == 11 ) {
						controlTable.columns(12).search('').draw();
					} else if( myval == 12 ) {
						controlTable.columns(13).search('').draw();
					} else if( myval == 13 ) {
						controlTable.columns(14).search('').draw();
					}

					//caseTable.columns(8).search(disease_name, true, false ).draw();

					var rows = $("#controlSample").dataTable().$('tr', {"filter":"applied"});
					controlTable.rows(rows).select();
				}


				$(document).on('change', '.search-boxControl', function(){
					feature_val = this.value;
					if(feature_val == 'Select feature'){}
					else
					{
						rendernew(this.id,feature_val);
						//controlFilter();
					}

				});


				function rendernew(iddnew,feature_val){

					row_id = iddnew.split('_')[2];

					$("#controlcolsm_" + row_id).html("");
					data = '';
					if (feature_val == "Tissue Type" || feature_val == 1){

						for(var i=0;i<contol_tissue_types.length;i++){
							data = data+'<div class="i-checks pull-left">'+
								'<label class="m-r-sm">'+
									'<input type="checkbox" checked name="control_type" group="controlType" value="'+ contol_tissue_types[i] +'"  class="controlfilter" data-column-index="2">'+
									'<i></i>'+ contol_tissue_types[i] +
								'</label>'+
							'</div>';
						}
					}else if (feature_val == "Site" || feature_val == 2){
						data = '<input type="text" name="control_site_hd" style="display:none;" class="controlfilter" data-column-index="4"><select  placeholder="Select Site" class="controlfilter search-boxControl" name="control_site" data-column-index="4">'+ // select2_demo_3
							'<option>Select Site</option>';
							{% for s in sites %}
								var str = '{{s}}'
								if(str == site)
									data = data + '<option value="{{ s }}">{{s}}</option>';
								else
									data = data + '<option value="{{ s }}" disabled>{{s}}</option>';
							{% endfor %}
						data = data + '</select>';

					}else if (feature_val == "Gender" || feature_val == 3){
						for(var i=0;i<contol_gender.length;i++){
							data = data + '<div class="i-checks pull-left m-r-sm">'+
								'<label>'+
									'<input type="radio" name="control_gender" value="'+contol_gender[i]+'" style="display:inline;margin-right:7px;"  class="controlfilter" data-column-index="5">'+
									contol_gender[i]+
								'</label>'+
								'</div>';
						}
					}else if (feature_val == "Metastatic Site" || feature_val == 4){
						data = '<input type="text" name="control_metastatic_hd" style="display:none;" class="controlfilter" data-column-index="6"><select placeholder="Select Metastatics" class="controlfilter search-boxControl" name="control_metastatic" data-column-index="6">'+
							'<option>Select Metastatics</option>';
							{% for m in metastatics %}
								var str = '{{m}}'
								var index = contol_metastatics.indexOf(str);
								if(index != -1)
									data = data + '<option value="{{ m }}">{{m}}</option>';
								else
									data = data + '<option value="{{ m }}" disabled>{{m}}</option>';
							{% endfor %}
						data = data + '</select>';
					}else if (feature_val == "EGFR" || feature_val == 5){
						for(var i=0;i<contol_egfr.length;i++){
							data = data+'<div class="i-checks pull-left">'+
								'<label class="m-r-sm">'+
									'<input type="checkbox" checked id="EGFRcontcheck" name="control_EGFR" group="controlEGFR" value="'+contol_egfr[i]+'"  class="controlfilter js-switch" data-column-index="8">'+
									'<i></i> '+contol_egfr[i]+
									'</label>'+
								'</div>';
						}
					}else if (feature_val == "IDH1" || feature_val == 6){
						for(var i=0;i<contol_idh1.length;i++){
							data = data+'<div class="i-checks pull-left">'+
								'<label class="m-r-sm">'+
									'<input type="checkbox" checked id="IDH1contcheck" name="control_IDH1" group="controlIDH1" value="'+contol_idh1[i]+'" class="controlfilter js-switch" data-column-index="9">'+
									'<i></i> '+contol_idh1[i]+
								'</label>'+
							'</div>';
						}
					}else if (feature_val == "IDH2" || feature_val == 7){
						for(var i=0;i<contol_idh2.length;i++){
							data = data+'<div class="i-checks pull-left">'+
								'<label class="m-r-sm">'+
									'<input type="checkbox" checked id="IDH2contcheck" name="control_IDH2" group="controlIDH2" value="'+contol_idh2[i]+'"  class="controlfilter js-switch" data-column-index="10">'+
									'<i></i> '+contol_idh2[i]+
								'</label>'+
							'</div>';
						}
					}else if (feature_val == "TP53" || feature_val == 8){
						for(var i=0;i<contol_tp53.length;i++){
							data = data+'<div class="i-checks pull-left">'+
								'<label class="m-r-sm">'+
									'<input type="checkbox" checked id="TP53contcheck" name="control_TP53" group="controlTP53" value="'+contol_tp53[i]+'" class="controlfilter js-switch" data-column-index="11">'+
										'<i></i> '+contol_tp53[i]+
									'</label>'+
								'</div>';
							}
					}else if (feature_val == "Age" || feature_val == 9){
						data = 	'<input type="text" id="controlAgeDisplay" name="control_age" data-column-index="14" class="controlfilter ageDisplayInput m-t-xs" readonly>'+
							'<div id="controlAgeSlider" class="ageSliderDiv m-t-sm" data-column-index="14"></div>'
					}else if (feature_val == "Tumor Grade" || feature_val == 10){
						data = '<input type="text" name="control_tumor_grade_hd" style="display:none;" class="controlfilter" data-column-index="12"><select placeholder="Select Grade"  class="controlfilter search-boxControl" name="control_tumor_grade" data-column-index="12">'+ // select2_demo_3
						   	'<option>Select Grade</option>';
							{% for g in grades %}
								var str = '{{g}}'
								var index = contol_grades.indexOf(str);
								if(index != -1)
									data = data + '<option value="{{ g }}">{{g}}</option>';
								else
									data = data + '<option value="{{ g }}" disabled>{{g}}</option>';
							{% endfor %}
						data = data + '</select>';
					}else if (feature_val == "Tumor Stage" || feature_val == 11){
						data = '<input type="text" name="control_tumor_stage_hd" style="display:none;" class="controlfilter" data-column-index="13"><select placeholder="Select Stage" class="search-boxControl" name="control_tumor_stage" multiple="multiple"  tabindex="4" data-column-index="13">' ;
							{% for st in stages %}
								var str = '{{st}}'
								var index = contol_stages.indexOf(str);
								if(index != -1)
									data = data + '<option value="{{ st }}">{{st}}</option>';
								else
									data = data + '<option value="{{ st }}" disabled>{{st}}</option>';
							{% endfor %}
						data = data + '</select>';
					}
					$("#controlcolsm_" + row_id).append(data);
					$(".search-boxControl").SumoSelect({search: true, searchText: 'Enter here.'});
					$("input[type='radio']").checkboxradio();
					$("fieldset[type='radio']").controlgroup();
					$(".controlfilter").on('change',function(){
						if($(this).val() =="Select Grade" || $(this).val() =="Select Metastatics" || $(this).val() =="Select Site"){

						}else {
							controlFilter();
							}
						});

					// age slider code --------------

					{% if not job or not job.jobs.0.ctrl_age_in_year %}
						$( "#controlAgeSlider" ).slider({
							range: true,
							min: 1,
							max: 100,
							values: [ 20, 60 ],
							slide: function( event, ui ) {
								$("#controlAgeDisplay").val(
									ui.values[ 0 ] + " - " +
									ui.values[ 1 ]
								);
							}
						});

						$("#controlAgeDisplay").val(
							$("#controlAgeSlider").slider("values",0) + " - " +
							$("#controlAgeSlider").slider("values",1)
						);
					{% endif %}
					// age slider code --------------

				};

			}//FINISH CONTROL JS===================================================================================================

            // Add event listener for opening and closing details
            $('#caseSample tbody').on('click', 'td.details-control', function () {
                var tr = $(this).closest('tr');
                var caseTable = $('#caseSample').DataTable();
                var row = caseTable.row( tr );

                if(row.child.isShown()) {
                    // This row is already open - close it
                    row.child.hide();
                    tr.removeClass('shown');
                }else {
                    // Open this row
                    row.child( format2(row.data()) ).show();
                    tr.addClass('shown');
                }
            });


            	var casecount = 0;

            // ---- Add Child Row Table -------------------------------

            // Add event listener for opening and closing details
            $('#controlSample tbody').on('click', 'td.details-control', function () {
                var tr = $(this).closest('tr');
                var row1 = controlTable.row( tr );

                if(row1.child.isShown()) {
                    // This row is already open - close it
                    row1.child.hide();
                    tr.removeClass('shown');
                }else {
                    // Open this row
                    row1.child( format2(row1.data()) ).show();
                    tr.addClass('shown');
                }
            });

            $(".searchBoxSign").SumoSelect({search: true, searchText: 'Enter here.'});
			$(".searchBoxDrugs").SumoSelect({search: true, searchText: 'Enter here.'});

            $("#saveJob").validate();

			// FILTER Samples for case and control===================================================

			<!--$("#validate_case_id").on('click', function(){-->

				<!--$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div><span style="color:black;">Computing Control Samples, it might take couple of minutes..</span>' });-->
				<!--setTimeout($.unblockUI, 500);-->

				<!--var sample_case_id = $("#manual_sample_case_id").val();-->
				<!--var strSampleCaseIdList = sample_case_id.replace( /\n/g, "|" ).split( " " );-->
				<!--var caseTable = $('#caseSample').DataTable();-->
				<!--caseTable.columns(2).search("^" + strSampleCaseIdList + "$", true, false, true).draw();-->

				<!--var intSampleTotalCount = $("#manual_sample_case_id").val().split("\n").length;-->
				<!--var resCount = $("#caseSample_info").text().split(" ");-->
				<!--if(intSampleTotalCount-resCount[5] > 0 ) {-->
					<!--swal("You have entered some wrong Sample ID");-->
				<!--} else {-->
					<!--swal("All Sample ID's are valid");-->
				<!--}-->
			<!--});-->

			$("#validate_control_id").on('click', function(){

				var sample_control_id = $("#manual_sample_control_id").val();
				var job_id = $("#job_id")[0].value;

				if( sample_control_id != '' ) {
					$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div><span style="color:black;">Computing Control Samples, it might take couple of minutes..</span>' });
					setTimeout($.unblockUI, 500);
					var url = "{{ url_for('dashboard.job_control', disease='manual_case') }}"
					$.ajax({
						url: url,
						type: "POST",
						contentType: 'application/json',
						data : JSON.stringify({"job_id": job_id, "control_samples": sample_control_id }),
						dataType:'json',
						async: false
					}).done(function (data) {
						//$.unblockUI();

						if (data == false){
							swal("Problem while creating the file");
						}else{
							swal("Control samples successfully created.");
						}
					}).fail(function (jqXHR, textStatus) {
						 //$.unblockUI();
						swal("Problem while creating the file");
					});

				} else {
					swal("Please enter the Control Sample ID's");
					return;
				}
			});

			$("#caserefbt").on('click', function(){
				//e.preventDefault();

				if( $("#ourCustomSelect").val() == '' ) {
					swal("Please select disease name")
				} else {

					if($('#hidden-data').val() == '1' ) {
						swal("Please select features")
					} else {
						$("div[id^='crow_']").remove();

						prev_obj = $(".diseaseNameSelect").children(".casePlusAddFilter");
						prev_obj[0].disabled = false;

						$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });
						setTimeout($.unblockUI, 2000);

						disease_name = $("#getDiseaseName").val();
						var caseTable = $('#caseSample').DataTable();
						caseTable.rows('.selected').deselect();
						caseTable.draw();

						for (var i = 2; i <= 17; i++) {
						  //caseTable.columns(i).search('').draw();
						  caseTable.columns(i).search('');
						}

						caseTable.columns(8).search("^" + disease_name + "$", true, false, true).draw();

						var rows = $("#caseSample").dataTable().$('tr', {"filter":"applied"});
						caseTable.rows(rows).select();
					}

					var res = $(".select-item").text().split(" ");
					if( parseInt(res[0]) >= 10 ) {
						$("#pageCount").remove();
					}
				}

				//$.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> ' });



			})

			$("#controlrefbt").on('click', function(){
				//e.preventDefault();
				var divids = $("div[id^='cnrow_']");
				if(divids.length > 0)
				{
					for(var i =2;i<=divids.length;i++)
					{
							$("#cnrow_"+i).remove();
					}
				}

				prev_obj = $(".innerControlSel").children(".controlPlusAddFilter");
				prev_obj[0].disabled = false;

				//disease_name = $("#getDiseaseName").val();
				var controlTable = $('#controlSample').DataTable();
				controlTable.rows('.selected').deselect();
				controlTable.draw();

				for (var i = 2; i <= 14; i++) {
				  controlTable.columns(i).search('').draw();
				}

				var rows = $("#controlSample").dataTable().$('tr', {"filter":"applied"});
				controlTable.rows(rows).select();

				site = site.split("-")[0].replace(' ', '')
				$("#controlcolsm_1 select[name=control_site]")[0].sumo.selectItem(site);
				//$("#controlbt").trigger('click');
				//controlFilter();
			})

			//==================================================================================================================================================================================



			$( "#caseSample_filter.dataTables_filter input" ).on( 'keyup change',function() {
			   //clear column search values
				caseTable.columns().search('');
			   //clear input values
			   $('.casefilter').val('');
			   $('.select-info').css('display','none');
			});


			/*$("#case_refresh").on('click', function(){
				case_plot()
			});

			$("#control_refresh").on('click', function(){
				control_plot()
			});*/






			$("#job_compute").on('click', function(){


				// call visualization of chart
				var de_method = $("#de_method").val();
				var dz_fc_threshold = $('#dz_fc_threshold').val();
				var dz_p_threshold = $('#dz_p_threshold').val();
				if(de_method == "0"){
					swal("Please select DE-method")
				} else {
					swal({
				    	title: "",
						text: "This might take couple of minutes and screen will be freezed down until the processing completes. Do you wish to continue ?",
						type: "warning",
						showCancelButton: true,
						confirmButtonColor: '#DD6B55',
						confirmButtonText: 'Yes, I am sure!',
						cancelButtonText: "No, cancel it!",
						closeOnConfirm: false,
						closeOnCancel: false
					}, function(isConfirm) {
						if (isConfirm) {
						   $(".sweet-alert").css("display", "none");
						   $(".sweet-overlay").css("display", "none");
						   $("#SignatureDiv").hide();
						   //$("#Signature-loader").show();
							if (de_method.length>0){
								 $.blockUI({ message: '<div class="full-width"><img src="/static/img/ajax-loader.gif" /></div> <span style="color:black;">Computing disease signature, it might take couple of minutes..</span> ' });
								var computeurl = "/job/compute";
								var job_id = $("#job_id")[0].value;
								var case_str = '';
								var rows = $("#caseSample").dataTable().$('tr', {"filter":"applied", "selected": true});
								case_ids = $('#caseSample').DataTable().rows(rows).data();
								if (case_ids.length>0){
									case_str = ''
									for (var i=0; i < case_ids.length ;i++){
										case_str = case_str + case_ids[i][2] + ','
									}
								}
								var control_str = '';
								var rows = $("#controlSample").dataTable().$('tr', {"filter":"applied", "selected": true});
								control_ids = $('#controlSample').DataTable().rows(rows).data();
								if (control_ids.length>0){
									control_str = ''
									for (var i=0; i < control_ids.length ;i++){
										control_str = control_str + control_ids[i][2] + ','
									}
								}

								$.ajax({
									url: computeurl,
									type: "POST",
									contentType: 'application/json',
									data : JSON.stringify({"de_method": de_method, "dz_fc_threshold": dz_fc_threshold,
									"dz_p_threshold": dz_p_threshold, "job_id": job_id, "case_str": case_str,
									"control_str": control_str}, null, '\t'),
									dataType:'json'
								}).done(function (data) {
									 $.unblockUI();
									if (data == "fail"){
										//$("#Signature-loader").hide();
										swal("Please try again")
									}else{
										$stopChanging = true;
										$("#SignatureDiv").show();
										//$("#Signature-loader").hide();
										$("#signatureImg").attr('src', data['signature'])
										enricher_data = data['enricher'];
										if (enricher_data.length){
											innerdata = ''
											for (var i = 0;i<enricher_data.length; i++){
												innerdata = innerdata + '<div class="col-lg-4"><iframe height="360px" src="'+ enricher_data[i] +'"></iframe></div>'
											}
											$("#dz_enricher").html(innerdata)
										}

										<!-- START : dg Code here -->
										var jobId = $("#job_id")[0].value;
										loadSingnatureCsv(jobId);
										loadUpSignatureCsv(jobId);
										loadDownSignatureCsv(jobId);
										<!-- END : dg Code here -->
									}
								}).fail(function (jqXHR, textStatus) {
								//	 $.unblockUI();
									$("#Signature-loader").hide();
									swal("Please try again")
								});
							}
							else{
								$("#Signature-loader").hide();
								swal("Please try again")
							}
						} else {
							$(".sweet-alert").css("display", "none");
							$(".sweet-overlay").css("display", "none");
						}
					});
				}
			});

			$("#page-loader").hide();

		}); 
		// End Document ready

	
	
		// ---- Add Child Row Table -------------------------------

		function format2 ( d ) {
			return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;width:100%;border: 1px solid;">'+
				'<tr>'+
					'<td style="font-weight:bold;width: 1%;">Gender:</td>'+
					'<td>'+d[6]+'</td>'+
					'<td style="font-weight:bold">Age:</td>'+
					'<td>'+d[4]+'</td>'+
					'<td style="font-weight:bold">Tumor Grade:</td>'+
					'<td>'+d[13]+'</td>'+
					'<td style="font-weight:bold">Tumor Stage:</td>'+
					'<td >'+d[14]+'</td>'+
				'</tr>'+
				'<tr>'+
					'<td style="font-weight:bold">Mutations:</td>'+
					'<td colspan="7"><textarea class="form-control" disabled>'+d[15]+'</textarea></td>'+
				'</tr>'+
				'<tr>'+
					'<td style="font-weight:bold">Gain:</td>'+
					'<td colspan="7"><textarea class="form-control" disabled>'+d[16]+'</textarea></td>'+
				'</tr>'+
				'<tr>'+
					'<td style="font-weight:bold">Loss:</td>'+
					'<td colspan="7"><textarea class="form-control" disabled>'+d[17]+'</textarea></td>'+
				'</tr>'+
			'</table>';
		}
		
	</script>



</body>
</html>
